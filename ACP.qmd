# Análisis de Componentes Principales

```{r}
#| echo: false
#| results: hide
#| message: false
#| warning: false

library(FactoClass)
library(plotly)
library(knitr)
library(readr)
library(dplyr)

# Carga de datos originales
saberpro <- read_delim("DATA_ICFES_SABERPROPROFESIONAL_2022-2.TXT", delim = "¬", escape_double = FALSE, trim_ws = TRUE)
kable(head(saberpro), digits=2) 

# nuestros datos
data <- saberpro[,-c(1,2,5:9,13:15,17:21,23:26,28:34,49:54,56:62,65,67:70,72:75,77:82,84:86,88:90,92:94,96:98,100:102,104:109)]

# genero
sum(is.na(data$ESTU_GENERO)) # hay 5 NA'S
data$ESTU_GENERO <- ifelse(is.na(data$ESTU_GENERO), "Desconocido", data$ESTU_GENERO)
data$ESTU_GENERO <- as.factor(data$ESTU_GENERO)
table(data$ESTU_GENERO)

# edad
# esta la quitamos
library(stringr)
edad <- str_sub(data$ESTU_FECHANACIMIENTO,7,10)
edad<-as.numeric(edad)
edades<-2023-edad

# etnia
sum(is.na(data$ESTU_TIENEETNIA)) # 775 na's
data$ESTU_TIENEETNIA <- ifelse(is.na(data$ESTU_TIENEETNIA), "Desconocido", data$ESTU_TIENEETNIA)
data$ESTU_TIENEETNIA <- as.factor(data$ESTU_TIENEETNIA)
table(data$ESTU_TIENEETNIA)

# depto
data$ESTU_DEPTO_RESIDE<-ifelse(data$ESTU_DEPTO_RESIDE %in% c("BARCELONA","BUENOS AIRES","FRANKFURT","HOUSTON","LIMA","MIAMI","NUEVA YORK","PARIS","QUEBEC","ROMA","SACRAMENTO","SANTIAGO DE CHILE","SAO PAULO","SEUL","TRENTON"),"EXTRANJERO",data$ESTU_DEPTO_RESIDE)
sum(is.na(data$ESTU_DEPTO_RESIDE))
length(unique(data$ESTU_DEPTO_RESIDE)) # hay 35 pq son mas los extranjeros y NAs
data$ESTU_DEPTO_RESIDE <- ifelse(is.na(data$ESTU_DEPTO_RESIDE), "Desconocido", data$ESTU_DEPTO_RESIDE)
data$ESTU_DEPTO_RESIDE <- as.factor(data$ESTU_DEPTO_RESIDE)
data <- data %>%
  mutate(ESTU_DEPTO_RESIDE = case_when(
    ESTU_DEPTO_RESIDE == "BOGOTÁ" ~ ESTU_DEPTO_RESIDE,
    ESTU_DEPTO_RESIDE == "Desconocido" ~ "Desconocido",
    TRUE ~ "OTRO"
  ))
data$ESTU_DEPTO_RESIDE <- as.factor(data$ESTU_DEPTO_RESIDE)
table(data$ESTU_DEPTO_RESIDE)


# estado civil
sum(is.na(data$ESTU_ESTADOCIVIL)) # 580 na's
data$ESTU_ESTADOCIVIL <- ifelse(is.na(data$ESTU_ESTADOCIVIL), "Desconocido", ifelse(data$ESTU_ESTADOCIVIL=="Casado","C",ifelse(data$ESTU_ESTADOCIVIL=="Separado y/o Viudo","SyoV",ifelse(data$ESTU_ESTADOCIVIL=="Soltero","S","UL"))))
data$ESTU_ESTADOCIVIL <- as.factor(data$ESTU_ESTADOCIVIL)
table(data$ESTU_ESTADOCIVIL)

# valor matricula
## recodificamos para que quede como factor
sum(is.na(data$ESTU_VALORMATRICULAUNIVERSIDAD)) # 2194 na's
data$ESTU_VALORMATRICULAUNIVERSIDAD <- ifelse(is.na(data$ESTU_VALORMATRICULAUNIVERSIDAD), "Desconocido", ifelse(data$ESTU_VALORMATRICULAUNIVERSIDAD=="Menos de 500 mil","m500",ifelse(data$ESTU_VALORMATRICULAUNIVERSIDAD=="Entre 500 mil y menos de 1 millón","e500m1",ifelse(data$ESTU_VALORMATRICULAUNIVERSIDAD=="Entre 1 millón y menos de 2.5 millones","e1m2.5",ifelse(data$ESTU_VALORMATRICULAUNIVERSIDAD=="Entre 2.5 millones y menos de 4 millones","e2.5m4",ifelse(data$ESTU_VALORMATRICULAUNIVERSIDAD=="Entre 4 millones y menos de 5.5 millones","e4m5.5",ifelse(data$ESTU_VALORMATRICULAUNIVERSIDAD=="Entre 5.5 millones y menos de 7 millones","e5.5m7",ifelse(data$ESTU_VALORMATRICULAUNIVERSIDAD=="Más de 7 millones","M7","NP"))))))))
data$ESTU_VALORMATRICULAUNIVERSIDAD <- factor(data$ESTU_VALORMATRICULAUNIVERSIDAD, levels = c("m500","e500m1", "e1m2.5", "e2.5m4","e4m5.5","e5.5m7","M7","NP","Desconocido"))
table(data$ESTU_VALORMATRICULAUNIVERSIDAD)

# capacitacion del examen
sum(is.na(data$ESTU_COMOCAPACITOEXAMENSB11)) # 2069 na's
data$ESTU_COMOCAPACITOEXAMENSB11 <- ifelse(is.na(data$ESTU_COMOCAPACITOEXAMENSB11), "Desconocido", ifelse(data$ESTU_COMOCAPACITOEXAMENSB11=="No realizó ninguna prueba de preparación","Ninguna",ifelse(data$ESTU_COMOCAPACITOEXAMENSB11=="Repasó por cuenta propia","CuentaPropia","Curso")))
data$ESTU_COMOCAPACITOEXAMENSB11 <- as.factor(data$ESTU_COMOCAPACITOEXAMENSB11)
table(data$ESTU_COMOCAPACITOEXAMENSB11)


# semestre que cursa
sum(is.na(data$ESTU_SEMESTRECURSA)) # 2194 na's
data$ESTU_SEMESTRECURSA<-ifelse(data$ESTU_SEMESTRECURSA %in% c("01","02","03","04","05","06"),"06m",ifelse(data$ESTU_SEMESTRECURSA=="12 o más","12M",data$ESTU_SEMESTRECURSA))
data$ESTU_SEMESTRECURSA <- ifelse(is.na(data$ESTU_SEMESTRECURSA), "Desconocido", data$ESTU_SEMESTRECURSA)
data$ESTU_SEMESTRECURSA <- as.factor(data$ESTU_SEMESTRECURSA)
table(data$ESTU_SEMESTRECURSA)

# educacion papa
sum(is.na(data$FAMI_EDUCACIONPADRE)) # 4738 na's
data$FAMI_EDUCACIONPADRE <- ifelse(is.na(data$FAMI_EDUCACIONPADRE), "Desconocido", ifelse(data$FAMI_EDUCACIONPADRE=="Educación profesional completa","EPC",ifelse(data$FAMI_EDUCACIONPADRE=="Educación profesional incompleta","EPI",ifelse(data$FAMI_EDUCACIONPADRE=="No Aplica","NAp",ifelse(data$FAMI_EDUCACIONPADRE=="No sabe","NS",ifelse(data$FAMI_EDUCACIONPADRE=="Postgrado","Post",ifelse(data$FAMI_EDUCACIONPADRE=="Primaria completa","PC",ifelse(data$FAMI_EDUCACIONPADRE=="Primaria incompleta","PI",ifelse(data$FAMI_EDUCACIONPADRE=="Secundaria (Bachillerato) completa","BC",ifelse(data$FAMI_EDUCACIONPADRE=="Secundaria (Bachillerato) incompleta","BI",ifelse(data$FAMI_EDUCACIONPADRE=="Técnica o tecnológica completa","TTC",ifelse(data$FAMI_EDUCACIONPADRE=="Técnica o tecnológica incompleta","TTI",data$FAMI_EDUCACIONPADRE))))))))))))
data$FAMI_EDUCACIONPADRE <- as.factor(data$FAMI_EDUCACIONPADRE)
table(data$FAMI_EDUCACIONPADRE)

# educacion mama
sum(is.na(data$FAMI_EDUCACIONMADRE)) # 4886 na's
data$FAMI_EDUCACIONMADRE <- ifelse(is.na(data$FAMI_EDUCACIONMADRE), "Desconocido", ifelse(data$FAMI_EDUCACIONMADRE=="Educación profesional completa","EPC",ifelse(data$FAMI_EDUCACIONMADRE=="Educación profesional incompleta","EPI",ifelse(data$FAMI_EDUCACIONMADRE=="No Aplica","NAp",ifelse(data$FAMI_EDUCACIONMADRE=="No sabe","NS",ifelse(data$FAMI_EDUCACIONMADRE=="Postgrado","Post",ifelse(data$FAMI_EDUCACIONMADRE=="Primaria completa","PC",ifelse(data$FAMI_EDUCACIONMADRE=="Primaria incompleta","PI",ifelse(data$FAMI_EDUCACIONMADRE=="Secundaria (Bachillerato) completa","BC",ifelse(data$FAMI_EDUCACIONMADRE=="Secundaria (Bachillerato) incompleta","BI",ifelse(data$FAMI_EDUCACIONMADRE=="Técnica o tecnológica completa","TTC",ifelse(data$FAMI_EDUCACIONMADRE=="Técnica o tecnológica incompleta","TTI",data$FAMI_EDUCACIONMADRE))))))))))))
data$FAMI_EDUCACIONMADRE <- as.factor(data$FAMI_EDUCACIONMADRE)
table(data$FAMI_EDUCACIONMADRE)

# ocupacion papa
sum(is.na(data$FAMI_OCUPACIONPADRE)) # 2060 na's
data$FAMI_OCUPACIONPADRE <- ifelse(is.na(data$FAMI_OCUPACIONPADRE), "Desconocido", ifelse(data$FAMI_OCUPACIONPADRE=="Empleado con cargo como director o gerente general","EDGG",ifelse(data$FAMI_OCUPACIONPADRE=="Empleado de nivel auxiliar o administrativo","ENAA",ifelse(data$FAMI_OCUPACIONPADRE=="Empleado de nivel directivo","END",ifelse(data$FAMI_OCUPACIONPADRE=="Empleado de nivel técnico o profesional","ENTP",ifelse(data$FAMI_OCUPACIONPADRE=="Empleado obrero u operario","EOO",ifelse(data$FAMI_OCUPACIONPADRE=="Empresario","Emp",ifelse(data$FAMI_OCUPACIONPADRE=="Hogar","H",ifelse(data$FAMI_OCUPACIONPADRE=="Otra actividad u ocupación","OAO", ifelse(data$FAMI_OCUPACIONPADRE=="Pensionado","Pen",ifelse(data$FAMI_OCUPACIONPADRE=="Pequeño empresario","PE",ifelse(data$FAMI_OCUPACIONPADRE=="Profesional independiente","PI","TCP"))))))))))))
data$FAMI_OCUPACIONPADRE <- as.factor(data$FAMI_OCUPACIONPADRE)
table(data$FAMI_OCUPACIONPADRE)

# ocupacion mama
sum(is.na(data$FAMI_OCUPACIONMADRE)) # 2060 na's
data$FAMI_OCUPACIONMADRE <- ifelse(is.na(data$FAMI_OCUPACIONMADRE), "Desconocido", ifelse(data$FAMI_OCUPACIONMADRE=="Empleado con cargo como director o gerente general","EDGG",ifelse(data$FAMI_OCUPACIONMADRE=="Empleado de nivel auxiliar o administrativo","ENAA",ifelse(data$FAMI_OCUPACIONMADRE=="Empleado de nivel directivo","END",ifelse(data$FAMI_OCUPACIONMADRE=="Empleado de nivel técnico o profesional","ENTP",ifelse(data$FAMI_OCUPACIONMADRE=="Empleado obrero u operario","EOO",ifelse(data$FAMI_OCUPACIONMADRE=="Empresario","Emp",ifelse(data$FAMI_OCUPACIONMADRE=="Hogar","H",ifelse(data$FAMI_OCUPACIONMADRE=="Otra actividad u ocupación","OAO", ifelse(data$FAMI_OCUPACIONMADRE=="Pensionado","Pen",ifelse(data$FAMI_OCUPACIONMADRE=="Pequeño empresario","PE",ifelse(data$FAMI_OCUPACIONMADRE=="Profesional Independiente","PI","TCP"))))))))))))
data$FAMI_OCUPACIONMADRE <- as.factor(data$FAMI_OCUPACIONMADRE)
table(data$FAMI_OCUPACIONMADRE)

# estrato
sum(is.na(data$FAMI_ESTRATOVIVIENDA)) # 5531 na's
data$FAMI_ESTRATOVIVIENDA <- ifelse(is.na(data$FAMI_ESTRATOVIVIENDA), "Desconocido", data$FAMI_ESTRATOVIVIENDA)
data$FAMI_ESTRATOVIVIENDA <- as.factor(data$FAMI_ESTRATOVIVIENDA)
table(data$FAMI_ESTRATOVIVIENDA)


# internet
sum(is.na(data$FAMI_TIENEINTERNET)) # 5697 na's
data$FAMI_TIENEINTERNET <- ifelse(is.na(data$FAMI_TIENEINTERNET), "Desconocido", data$FAMI_TIENEINTERNET)
data$FAMI_TIENEINTERNET <- as.factor(data$FAMI_TIENEINTERNET)
table(data$FAMI_TIENEINTERNET)

# computador
sum(is.na(data$FAMI_TIENECOMPUTADOR)) # 6163 na's
data$FAMI_TIENECOMPUTADOR <- ifelse(is.na(data$FAMI_TIENECOMPUTADOR), "Desconocido", data$FAMI_TIENECOMPUTADOR)
data$FAMI_TIENECOMPUTADOR <- as.factor(data$FAMI_TIENECOMPUTADOR)
table(data$FAMI_TIENECOMPUTADOR)

# lavadora
sum(is.na(data$FAMI_TIENELAVADORA)) # 6354 na's
data$FAMI_TIENELAVADORA <- ifelse(is.na(data$FAMI_TIENELAVADORA), "Desconocido", data$FAMI_TIENELAVADORA)
data$FAMI_TIENELAVADORA <- as.factor(data$FAMI_TIENELAVADORA)
table(data$FAMI_TIENELAVADORA)

# microogas
sum(is.na(data$FAMI_TIENEHORNOMICROOGAS)) # 7019 na's
data$FAMI_TIENEHORNOMICROOGAS <- ifelse(is.na(data$FAMI_TIENEHORNOMICROOGAS), "Desconocido", data$FAMI_TIENEHORNOMICROOGAS)
data$FAMI_TIENEHORNOMICROOGAS <- as.factor(data$FAMI_TIENEHORNOMICROOGAS)
table(data$FAMI_TIENEHORNOMICROOGAS)

# tv
sum(is.na(data$FAMI_TIENESERVICIOTV)) # 5801 na's
data$FAMI_TIENESERVICIOTV <- ifelse(is.na(data$FAMI_TIENESERVICIOTV), "Desconocido", data$FAMI_TIENESERVICIOTV)
data$FAMI_TIENESERVICIOTV <- as.factor(data$FAMI_TIENESERVICIOTV)
table(data$FAMI_TIENESERVICIOTV)

# auto
sum(is.na(data$FAMI_TIENEAUTOMOVIL)) # 7187 na's
data$FAMI_TIENEAUTOMOVIL <- ifelse(is.na(data$FAMI_TIENEAUTOMOVIL), "Desconocido", data$FAMI_TIENEAUTOMOVIL)
data$FAMI_TIENEAUTOMOVIL <- as.factor(data$FAMI_TIENEAUTOMOVIL)
table(data$FAMI_TIENEAUTOMOVIL)

# moto
sum(is.na(data$FAMI_TIENEMOTOCICLETA)) # 7525 na's
data$FAMI_TIENEMOTOCICLETA <- ifelse(is.na(data$FAMI_TIENEMOTOCICLETA), "Desconocido", data$FAMI_TIENEMOTOCICLETA)
data$FAMI_TIENEMOTOCICLETA <- as.factor(data$FAMI_TIENEMOTOCICLETA)
table(data$FAMI_TIENEMOTOCICLETA)

# consola
sum(is.na(data$FAMI_TIENECONSOLAVIDEOJUEGOS)) # 7993 na's
data$FAMI_TIENECONSOLAVIDEOJUEGOS <- ifelse(is.na(data$FAMI_TIENECONSOLAVIDEOJUEGOS), "Desconocido", data$FAMI_TIENECONSOLAVIDEOJUEGOS)
data$FAMI_TIENECONSOLAVIDEOJUEGOS <- as.factor(data$FAMI_TIENECONSOLAVIDEOJUEGOS)
table(data$FAMI_TIENECONSOLAVIDEOJUEGOS)

# horas trabaja
sum(is.na(data$ESTU_HORASSEMANATRABAJA)) # 6867 na's
data$ESTU_HORASSEMANATRABAJA <- ifelse(is.na(data$ESTU_HORASSEMANATRABAJA), "Desconocido", data$ESTU_HORASSEMANATRABAJA)
data$ESTU_HORASSEMANATRABAJA <- factor(data$ESTU_HORASSEMANATRABAJA, levels = c("0", "Menos de 10 horas", "Entre 11 y 20 horas", "Entre 21 y 30 horas", "Más de 30 horas", "Desconocido"))
table(data$ESTU_HORASSEMANATRABAJA)

# grupo de referencia
sum(is.na(data$GRUPOREFERENCIA)) # 0 na's
data$GRUPOREFERENCIA<-ifelse(data$GRUPOREFERENCIA=="ADMINISTRACIÓN Y AFINES","AdmYAfin",ifelse(data$GRUPOREFERENCIA=="ARQUITECTURA Y URBANISMO","ArqYUrb",ifelse(data$GRUPOREFERENCIA=="BELLAS ARTES Y DISEÑO","BelArtYDis",ifelse(data$GRUPOREFERENCIA=="CIENCIAS AGROPECUARIAS","CienAgr",ifelse(data$GRUPOREFERENCIA=="CIENCIAS MILITARES Y NAVALES","CienMilYNav",ifelse(data$GRUPOREFERENCIA=="CIENCIAS NATURALES Y EXACTAS","CienNatYExac",ifelse(data$GRUPOREFERENCIA=="CIENCIAS SOCIALES","CienSoc",ifelse(data$GRUPOREFERENCIA=="COMUNICACIÓN, PERIODISMO Y PUBLICIDAD","ComuPerYPub",ifelse(data$GRUPOREFERENCIA=="CONTADURÍA Y AFINES","ContYAfin",ifelse(data$GRUPOREFERENCIA=="DERECHO","Derecho",ifelse(data$GRUPOREFERENCIA=="ECONOMÍA","Economía",ifelse(data$GRUPOREFERENCIA=="ECONOMÍA, ADMINISTRACIÓN, CONTADURÍA Y AFINES - UNIVERSITARIA","EcAdContYAfinU",ifelse(data$GRUPOREFERENCIA=="EDUCACIÓN","Educación",ifelse(data$GRUPOREFERENCIA=="ENFERMERÍA","Enfermeria",ifelse(data$GRUPOREFERENCIA=="GRUPO REFERENCIA NACIONAL","GrupRefNal", ifelse(data$GRUPOREFERENCIA=="GRUPO REFERENCIA NACIONAL UNIVERSITARIO","GrupRefNalU", ifelse(data$GRUPOREFERENCIA=="HUMANIDADES","Hum", ifelse(data$GRUPOREFERENCIA=="INGENIERÍA","Inge", ifelse(data$GRUPOREFERENCIA=="MEDICINA","Med", ifelse(data$GRUPOREFERENCIA=="PSICOLOGÍA","Psic", ifelse(data$GRUPOREFERENCIA=="RECREACIÓN Y DEPORTES","RecYDep", "salud")))))))))))))))))))))
data$GRUPOREFERENCIA<- as.factor(data$GRUPOREFERENCIA)
table(data$GRUPOREFERENCIA)
str(data$GRUPOREFERENCIA) # 22 niveles

# metodo
sum(is.na(data$ESTU_METODO_PRGM)) # 0 na's
data$ESTU_METODO_PRGM <- ifelse(data$ESTU_METODO_PRGM == "DISTANCIA VITUAL", "distVirtual", ifelse(data$ESTU_METODO_PRGM=="DISTANCIA","distancia","presencial"))
data$ESTU_METODO_PRGM<- as.factor(data$ESTU_METODO_PRGM)
table(data$ESTU_METODO_PRGM)

# caracter academico institucion
sum(is.na(data$INST_CARACTER_ACADEMICO)) # 0 na's
data$INST_CARACTER_ACADEMICO<-ifelse(data$INST_CARACTER_ACADEMICO=="INSTITUCIÓN TECNOLÓGICA","InstTec",ifelse(data$INST_CARACTER_ACADEMICO=="INSTITUCIÓN UNIVERSITARIA","InstUni", ifelse(data$INST_CARACTER_ACADEMICO=="TÉCNICA PROFESIONAL","TecProf", "Universidad")))
data$INST_CARACTER_ACADEMICO<- as.factor(data$INST_CARACTER_ACADEMICO)
table(data$INST_CARACTER_ACADEMICO)

names(data)[29:33]<-c("cuanti","lec","ciu","ing","esc")
```

Miremos la correlación de las variables cuantitativas

```{r}
#| echo: false
Y <- data[, 29:33] # Puntaje global va a ser ilustrativa
colnames(Y)<-c("cuanti","lec","ciu","ing","esc")
kable(cor(Y), digits = 3)
heatmap(cor(Y), NA, NA)
```

Varias variables parecen estar correlacionadas de manera moderada mientras otras variables tienen una correlación fuerte. La variable que menos se correlaciona con las otras es el puntaje en Comunicación Escrita, de ahí, la variable que más se correlaciona con las otras es el puntaje en Lectura Crítica.

Luego de realizar el ACP usando la función $\texttt{dudi.pca}$ de la librería $\texttt{ade4}$, la inercia (o los valores propios de los nuevos ejes) son

```{r}
#| echo: false
acp <- dudi.pca(Y, scannf = FALSE, nf = 2) # nf indica cuantos ejes voy a conservar
valp <- t(inertia(acp)$tot.inertia) # valores propios
kable(valp, digits = 3)

barplot(acp$eig, horiz = TRUE) # histograma de valores propios
abline(v = 1, lty = 3)
```

Para el análisis, se conservan los dos primeros ejes porque el primero tiene un valor propio mayor a 1 y el segundo es cercano a 1, además, con esos dos ejes se tiene casi el 74.41% de la inercia. Cabe mencionarse que como el valor propio del primer eje es casi 3, se puede decir que este eje "explica mucho".

Con los nuevos ejes las nuevas coordenadas son:

```{r}
#| echo: false
kable(acp$co, digits = 3)
s.corcircle(acp$co)
```

Usaremos la variable de "Puntaje global" como ilustrativa y sus nuevas coordenadas son:

```{r}
#| echo: false
# exam como ilustrativa
GGlob <- cor(data$PUNT_GLOBAL, acp$li)
rownames(GGlob)<-"Global"
kable(GGlob, digits = 3)
```

```{r}
#| echo: false
s.corcircle(acp$co)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
```

El Puntaje Global y la mayoría de las varibles excepto "Puntaje de Comunicación Escrita" están muy correlacionadas con el primer eje. Además, debido a que todas las variables están correlacionadas con el primer eje de manera positiva, tenemos que el primer eje es un "factor tamaño". El segundo eje divide los componentes en Comunicación Escrita por una parte y por otra parte todos los demás, sin embargo, no representa muy bien a los demás componentes. Se ve claramente que el Componente más correlacionado al segundo eje es el de Comunicación Escrita. Además de esto, visualmente se aprecia que con sólo dos ejes están bien representados todos los componentes.

### ACP tres ejes

Solo para observar, se hace un ACP conservando tres ejes, el segundo plano nos permite ver que el tercer eje separa los puntajes de comprensión escrita, ingles y global, con los puntajes de razonamiento cuantitativo, lectura crítica y competencias ciudadanas. Además, este tercer eje no parece tener mucha correlación con la mayoría de los puntajes a excepción del puntaje de inglés.

```{r}
#| echo: false
acp1 <- dudi.pca(Y, scannf = FALSE, nf = 3) 
GGlob1 <- cor(data$PUNT_GLOBAL, acp1$li)

# Plano con los ejes 1 y 2
rownames(GGlob1)<-"Global"
#s.corcircle(acp1$co)
#s.arrow(GGlob1, add.plot = TRUE, boxes = FALSE)

# Plano con los ejes 2 y 3
s.corcircle(acp1$co, xax = 2, yax = 3)
s.arrow(GGlob1, xax = 2, yax = 3, 
        add.plot = TRUE, boxes = FALSE)
```

::: callout-important
ESTO DEBERÍAMOS PONERLO DE OTRA FORMA Y EN OTRO LADO. Se quitaron las variables INST_NOMBRE_INSTITUCION, ESTU_PRGM_ACADEMICO, ESTU_COD_RESIDE_DEPTO y ESTU_FECHANACIMIENTO
:::

```{r}
#| echo: false
Ysupcat <- data[,c(1,3:4,6:23,26:28)]
Ysupcat<-as.data.frame(Ysupcat)
sup <- supqual(acp, Ysupcat)
```

```{r}
#| echo: false
#| eval: false
kable(cbind(wcat = sup$wcat, d2 = sup$dis2, sup$coor), 
      digits = 3)
kable(cbind(sup$tv, sup$cos2), digits = 3)
```

::: callout-note
Note que para el análisis del ACP se continuó teniendo en cuenta únicamente dos ejes.
:::

## Variables relacionadas con la información personal

::: panel-tabset
## Sexo

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
pes_dist_coor<-cbind(wcat = sup$wcat, d2 = sup$dis2, sup$coor)
kable(pes_dist_coor[1:3,], 
      digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
test_cos<-cbind(sup$tv, sup$cos2)
kable(head(test_cos[1:3,]), digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[1:3,], col = 6, pch = 16,
     #xlim = c(-1,1), ylim = c(-1,1), # si le ponemos esta linea entonces queda de -1 a 1 pero no se ve Desconocido
     xlim = c(min(sup$coor[1:3,]-0.2),1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[1:3,], labels = rownames(sup$coor[1:3,]),
     col = 6, pos = 1, font = 3)
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[1:3,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[1:3,], col = 6, pch = 16)
text(sup$coor[1:3,], labels = rownames(sup$coor[1:3,]),
     col = 6, pos = 1, font = 3, srt=-45)
```
Se ve que los hombres se caracterizan por tener en promedio puntajes superiores a las mujeres. Vemos que el grupo "Desconocido" está muy lejos en el plano factorial, debido a que sólo 5 individuos pertenecen a este grupo, su valor test logra ser mayor a dos, sin embargo, al ser tan pocos individuos respecto a la población total, puede llevar a conclusiones erróneas. La correlación de esta variable con el primer eje es baja pero importante mientras que con el segundo eje es casi nula.

## Etnia

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
kable(pes_dist_coor[4:6,], 
      digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
kable(head(test_cos[4:6,]), digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[4:6,], col = 6, pch = 16,
     xlim = c(-1,1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[4:6,], labels = rownames(sup$coor[4:6,]),
     col = 6, pos = 1, font = 3)
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[4:6,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[4:6,], col = 6, pch = 16)
text(sup$coor[4:6,], labels = rownames(sup$coor[4:6,]),
     col = 6, pos = 1, font = 3, srt=-45)
```
En promedio, las personas que sí tienen etnia tienen peores puntajes que el promedio global mientras que los que no tienen etnia se caracterizan por tener en promedio un puntaje mejor que el promedio global. Para los individuos cuya etnia es desconocida, se caracterizan por tener puntajes que en promedio son menores al promedio global, aunque cabe recordar que sólo 775 individuos pertenecen a este grupo, siendo un porcentaje muy pequeño de la población.

## Departamento

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
kable(pes_dist_coor[7:9,], 
      digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
kable(head(test_cos[7:9,]), digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[7:9,], col = 6, pch = 16,
     xlim = c(-1,1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[7:9,], labels = rownames(sup$coor[7:9,]),
     col = 6, pos = 1, font = 3)
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[7:9,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[7:9,], col = 6, pch = 16)
text(sup$coor[7:9,], labels = rownames(sup$coor[7:9,]),
     col = 6, pos = 1, font = 3, srt=-45)
```
Se ve que los individuos que residen en Bogotá tienen en promedio mejores puntajes que la población general mientras que los que residen en otro lugar tienen en promedio peores puntajes. Para las personas a las cuales no se conoce el lugar de residencia, no parecen tener puntajes ni peores ni mejores. Tampoco parece haber diferencia del desempeño en el componente de Comunicación Escrita por lugar de residencia. 

## Estado civil

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
kable(pes_dist_coor[10:14,], 
      digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
kable(head(test_cos[10:14,]), digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[10:14,], col = 6, pch = 16,
     xlim = c(-1,1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[10:14,], labels = rownames(sup$coor[10:14,],),
     col = 6, pos = 1, font = 3, srt=-45) # srt es para rotar el texto
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[10:14,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[10:14,], col = 6, pch = 16)
text(sup$coor[10:14,], labels = rownames(sup$coor[10:14,]),
     col = 6, pos = 1, font = 3, srt=-45)
```

Se ve que las personas solteras tienen en promedio mejores puntajes que los individuos con otros estados civiles. Para las personas con estado civil desconido, no parecen tener en promedio puntajes más altos o bajos respecto a la media global.

## Educación padre

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
kable(pes_dist_coor[36:48,], digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
kable(test_cos[36:48,], digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[36:48,], col = 6, pch = 16,
     xlim = c(-1,1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[36:48,], labels = rownames(sup$coor[36:48,],),
     col = 6, pos = 1, font = 3, srt=-45) # srt es para rotar el texto
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[36:48,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[36:48,], col = 6, pch = 16)
text(sup$coor[36:48,], labels = rownames(sup$coor[36:48,]),
     col = 6, pos = 1, font = 3, srt=-45)
```
Vemos que personas con padres con un nivel educativo más alto tienen mejores puntajes, siendo que en promedio los mejores puntajes son de individuos con padres que tienen un posgrado mientras que en promedio los puntajes más bajos son de individuos con primaria completa, primaria incompleta o directamente ningún nivel educativo. 

## Educación madre

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
kable(pes_dist_coor[49:61,], digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
kable(test_cos[49:61,], digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[49:61,], col = 6, pch = 16,
     xlim = c(-1,1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[49:61,], labels = rownames(sup$coor[49:61,],),
     col = 6, pos = 1, font = 3, srt=-45) # srt es para rotar el texto
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[49:61,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[49:61,], col = 6, pch = 16)
text(sup$coor[49:61,], labels = rownames(sup$coor[49:61,]),
     col = 6, pos = 1, font = 3, srt=-45)
```
Mismo caso que con la educación del padre, los individuos con madres que tienen posgrados tienen los mejores puntajes respecto al promedio, mientras que los individuos cuyas madres no tienen ningún nivel educativo tienen los peores puntajes en promedio.

## Ocupación padre

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
kable(pes_dist_coor[62:74,], digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
kable(test_cos[62:74,], digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[62:74,], col = 6, pch = 16,
     xlim = c(-1,1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[62:74,], labels = rownames(sup$coor[62:74,],),
     col = 6, pos = 1, font = 3, srt=-45) # srt es para rotar el texto
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[62:74,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[62:74,], col = 6, pch = 16)
text(sup$coor[62:74,], labels = rownames(sup$coor[62:74,]),
     col = 6, pos = 1, font = 3, srt=-45)
```
Se ve que, en promedio son mejores los puntajes de los individuos con padres cuya ocupación es son Empleado de nivel técnico o profesional, seguidos de Profesional independiente, Empleado con cargo como director o gerente general, Empleado de nivel directivo, Desconocido, Pequeño empresario, Empleado de nivel auxiliar o administrativo y Pensionado. De ahí, los individuos con padres cuya ocupación es otra tienen peores puntajes en promedio respecto al puntaje promedio global. Resalta el hecho de que los individuos para los que la ocupación del padre es el hogar tienen en promedio los peores puntajes.

## Ocupación madre

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
kable(pes_dist_coor[75:87,], digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
kable(test_cos[75:87,], digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[75:87,], col = 6, pch = 16,
     xlim = c(-1,1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[75:87,], labels = rownames(sup$coor[75:87,],),
     col = 6, pos = 1, font = 3, srt=-45) # srt es para rotar el texto
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[75:87,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[75:87,], col = 6, pch = 16)
text(sup$coor[75:87,], labels = rownames(sup$coor[75:87,]),
     col = 6, pos = 1, font = 3, srt=-45)
```
Mismo caso que la variable anterior. Madres con ocupaciones como Empleado con cargo como director o gerente general, Profesional independiente o Empleado de nivel directivo aparecen en individuos con mejores puntajes que el promedio mientras que individuos con madres cuya ocupación es Hogar, Trabajador por cuenta propia o Otra actividad u ocupación tienen en promedio puntajes peores al promedio global. Resalta que individuos con madres cuya ocupación es Empleado obrero u operario tienen en promedio puntajes que no difieren mucho del promedio global.

## Horas trabaja

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
kable(pes_dist_coor[120:125,], digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
kable(head(test_cos[120:125,]), digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[120:125,], col = 6, pch = 16,
     xlim = c(-1,1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[120:125,], labels = rownames(sup$coor[120:125,],),
     col = 6, pos = 1, font = 3, srt=-45) # srt es para rotar el texto
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[120:125,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[120:125,], col = 6, pch = 16)
text(sup$coor[120:125,], labels = rownames(sup$coor[120:125,]),
     col = 6, pos = 1, font = 3, srt=-45)
```
Individuos que no trabajan tienen en promedio puntajes más altos que el promedio global y notoriamente más altos respecto a todos los demás grupos. Se ve en los valores test que a medida que las horas de trabajo aumentan, los puntajes en promedio disminuyen, llegando a que en promedio las personas que trabajan 30 horas tienen los peores puntajes. Esto sin contar a los individuos cuyas horas de trabajo son desconocidas, pues estos tienen el valor test más grande de todos, asociado a peores puntajes respecto a la media, y siendo 6867 individuos, son una porción relativamente importante de la población.

:::

Primero que nada, resaltó un patrón en los cosenos cuadrados de las categorías de todas las variables, el cual era que las categorías "Desconocido", que hacen referencia a los datos faltantes en cada variable, eran las que más tenían correlación con el segundo eje, mientras que todas las demás categorías tenían correlaciones muy pequeñas o casi nulas.

Se vio que personas con padres y madres en ocupaciones que a menudo son mejor remuneradas y con niveles educativos más altos tienen mejores puntajes. Los hombres parecen tener mejores puntajes en promedio que las mujeres, y la presencia de Etnia también resulta una caracteristica de personas con peores puntajes respecto al promedio. El estado civil y el departamento en el que se reside también caracteriza a los puntajes, siendo que las personas solteras tienen en promedio mejores puntajes que las personas con otro estado civil, y que las personas que residen en Bogotá tienen en promedio mejores puntajes que las personas que residen en otros departamentos.

## Variables relacionadas con la información académica

::: panel-tabset
## Capacitación examen

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
kable(pes_dist_coor[24:27,], 
      digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
kable(head(test_cos[24:27,]), digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[24:27,], col = 6, pch = 16,
     xlim = c(-1,1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[24:27,], labels = rownames(sup$coor[24:27,],),
     col = 6, pos = 1, font = 3, srt=-45) # srt es para rotar el texto
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[24:27,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[24:27,], col = 6, pch = 16)
text(sup$coor[24:27,], labels = rownames(sup$coor[24:27,]),
     col = 6, pos = 1, font = 3, srt=-45)
```

Curiosamente los individuos que no tuvieron ninguna preparación son los que en promedio tienen puntajes más altos, seguidos de a los que se desconoce su capacitación del examen, mientras que los que se prepararon por cuenta propia tienen los peores puntajes en promedio, seguidos de los individuos que se prepararon con un curso.

## Semestre que cursa

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
kable(pes_dist_coor[28:35,], digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
kable(test_cos[28:35,], digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[28:35,], col = 6, pch = 16,
     xlim = c(-1,1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[28:35,], labels = rownames(sup$coor[28:35,],),
     col = 6, pos = 1, font = 3, srt=-45) # srt es para rotar el texto
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[28:35,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[28:35,], col = 6, pch = 16)
text(sup$coor[28:35,], labels = rownames(sup$coor[28:35,]),
     col = 6, pos = 1, font = 3, srt=-45)
```
Los estudiantes que están cursando su onceavo semestre y los que están en su doceavo semestre o más son los que tienen mejores puntajes en promedio, mientras que todos los demás tienen puntajes peores al promedio, a excepción de los estudiantes cuyo semestre es desconocido, para los cuales también se aprecia que sus puntajes en promedio son mayores al promedio de la población.

## Grupo referencia

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
kable(pes_dist_coor[126:147,], digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
kable(test_cos[126:147,], digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[126:147,], col = 6, pch = 16,
     xlim = c(-1,1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[126:147,], labels = rownames(sup$coor[126:147,],),
     col = 6, pos = 1, font = 3, srt=-45) # srt es para rotar el texto
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[126:147,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[126:147,], col = 6, pch = 16)
text(sup$coor[126:147,], labels = rownames(sup$coor[126:147,]),
     col = 6, pos = 1, font = 3, srt=-45)
```
Gracias a los valores test podemos apreciar que individuos que pertenecen a los grupos de referencia Medicina, Ingeniería, Econ.,admin.,contad. y afines Univer., Ciencias naturales y exactas y Economía tienen en promedio mejores puntajes, mientras que individuos que pertenecen a grupos de referencia tales como Educación, Administración y afines o Contaduría y afines son los que tienen en promedio peores puntajes respecto al resto de individuos. Además, los individuos cuyo gurpo de referencia es Ciencias agrarias tienen puntajes que en promedio no difieren del promedio global.

## Modalidad

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
kable(pes_dist_coor[148:150,], digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
kable(head(test_cos[148:150,]), digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[148:150,], col = 6, pch = 16,
     xlim = c(-1,1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[148:150,], labels = rownames(sup$coor[148:150,],),
     col = 6, pos = 1, font = 3, srt=-45) # srt es para rotar el texto
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[148:150,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[148:150,], col = 6, pch = 16)
text(sup$coor[148:150,], labels = rownames(sup$coor[148:150,]),
     col = 6, pos = 1, font = 3, srt=-45)
```
Se observa que individuos cuya modalidad de estudio es presencial tienen mejores puntajes que el promedio, y que individiuos cuya modalidad de estudio es a distancia o a distancia virtual, teniendo estos últimos puntajes peores en promedio que el puntaje promedio global.

## Carácter académico

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
kable(pes_dist_coor[151:154,], digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
kable(head(test_cos[151:154,]), digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[151:154,], col = 6, pch = 16,
     xlim = c(-1,1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[151:154,], labels = rownames(sup$coor[151:154,],),
     col = 6, pos = 1, font = 3, srt=-45) # srt es para rotar el texto
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[151:154,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[151:154,], col = 6, pch = 16)
text(sup$coor[151:154,], labels = rownames(sup$coor[151:154,]),
     col = 6, pos = 1, font = 3, srt=-45)
```

Los individuos cuya institución es una Universidad tienen en promedio puntajes mejores a individuos que pertenecen a Instituciones tecnológicas, Técnicas profesionales e Instituciones universitarias, siendo estos últimos los que en promedio tienen los peores puntajes.

:::

Resulta curioso cómo las personas con ninguna capacitación tienen mejores puntajes que personas que se capacitaron de alguna otra manera, sin embargo, esto puede ser explicado debido a lo común de estas categorías, pues un patrón que se repitió en las anteriores variables a excepción del semestre que cursa el individuo y el grupo de referencia, es que para las categorías más comunes, como lo son pertenecer a una universidad, no prepararse de ninguna manera para el examen o estudiar en modalidad presencial. En el caso de los grupos de referencia, grupos que son más asociados a las ciencias y las matemáticas tienen en promedio mejores puntajes que los demás. También se vio que estudiantes que cursan los semestres más avanzados son los que tienen puntajes más altos, lo cual puede relacionarse al grupo de referencia medicina, siendo esta la carrera más extensa, por lo que puede parecer que estudiantes de medicina tienen mejores puntajes y por la naturaleza de su carrera, se encuentran en semestres más avanzados.

## Variables relacionadas con la información socioeconómica

::: panel-tabset
## Valor matrícula

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
kable(pes_dist_coor[15:23,], 
      digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
kable(test_cos[15:23,], digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[15:23,], col = 6, pch = 16,
     xlim = c(-1,1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[15:23,], labels = rownames(sup$coor[15:23,],),
     col = 6, pos = 1, font = 3, srt=-45) # srt es para rotar el texto
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[15:23,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[15:23,], col = 6, pch = 16)
text(sup$coor[15:23,], labels = rownames(sup$coor[15:23,]),
     col = 6, pos = 1, font = 3, srt=-45)
```
Resalta que los que pagan más de 7 millones tienen en promedio puntajes mucho más altos que el promedio global. Los individuos que pagan entre 5.5 y 7 millones, los que pagan menos de 500 mil pesos y a los que se desconoce cuanto pagan también tienen en promedio, puntajes mejores al promedio global. De ahí, todos los demás puntajes son peores en promedio al puntaje promedio de la población.

## Estrato

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
kable(pes_dist_coor[88:95,], digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
kable(test_cos[88:95,], digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[88:95,], col = 6, pch = 16,
     xlim = c(-1,1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[88:95,], labels = rownames(sup$coor[88:95,],),
     col = 6, pos = 1, font = 3, srt=-45) # srt es para rotar el texto
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[88:95,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[88:95,], col = 6, pch = 16)
text(sup$coor[88:95,], labels = rownames(sup$coor[88:95,]),
     col = 6, pos = 1, font = 3, srt=-45)
```
En cuanto al estrato, se ve que claramente los mejores estratos tienen en promedio, mejores puntajes, y a medida que el estrato disminuye, el promedio de los puntajes también disminuye.

## Internet

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
kable(pes_dist_coor[96:98,], digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
kable(test_cos[96:98,], digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[96:98,], col = 6, pch = 16,
     xlim = c(-1,1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[96:98,], labels = rownames(sup$coor[96:98,],),
     col = 6, pos = 1, font = 3, srt=-45) # srt es para rotar el texto
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[96:98,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[96:98,], col = 6, pch = 16)
text(sup$coor[96:98,], labels = rownames(sup$coor[96:98,]),
     col = 6, pos = 1, font = 3, srt=-45)
```
Debido al parecido de esta variable y las siguientes variables, la interpretación de estas quedará en el resumen de esta subsección.

## Computador

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
kable(pes_dist_coor[99:101,], digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
kable(head(test_cos[99:101,]), digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[99:101,], col = 6, pch = 16,
     xlim = c(-1,1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[99:101,], labels = rownames(sup$coor[99:101,],),
     col = 6, pos = 1, font = 3, srt=-45) # srt es para rotar el texto
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[99:101,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[99:101,], col = 6, pch = 16)
text(sup$coor[99:101,], labels = rownames(sup$coor[99:101,]),
     col = 6, pos = 1, font = 3, srt=-45)
```

## Lavadora

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
kable(pes_dist_coor[102:104,], digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
kable(head(test_cos[102:104,]), digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[102:104,], col = 6, pch = 16,
     xlim = c(-1,1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[102:104,], labels = rownames(sup$coor[102:104,],),
     col = 6, pos = 1, font = 3, srt=-45) # srt es para rotar el texto
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[102:104,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[102:104,], col = 6, pch = 16)
text(sup$coor[102:104,], labels = rownames(sup$coor[102:104,]),
     col = 6, pos = 1, font = 3, srt=-45)
```

## Horno microogas

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
kable(pes_dist_coor[105:107,], digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
kable(head(test_cos[105:107,]), digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[105:107,], col = 6, pch = 16,
     xlim = c(-1,1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[105:107,], labels = rownames(sup$coor[105:107,],),
     col = 6, pos = 1, font = 3, srt=-45) # srt es para rotar el texto
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[105:107,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[105:107,], col = 6, pch = 16)
text(sup$coor[105:107,], labels = rownames(sup$coor[105:107,]),
     col = 6, pos = 1, font = 3, srt=-45)
```

## TV

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
kable(pes_dist_coor[108:110,], digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
kable(head(test_cos[108:110,]), digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[108:110,], col = 6, pch = 16,
     xlim = c(-1,1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[108:110,], labels = rownames(sup$coor[108:110,],),
     col = 6, pos = 1, font = 3, srt=-45) # srt es para rotar el texto
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[108:110,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[108:110,], col = 6, pch = 16)
text(sup$coor[108:110,], labels = rownames(sup$coor[108:110,]),
     col = 6, pos = 1, font = 3, srt=-45)
```

## Automóvil

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
kable(pes_dist_coor[111:113,], digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
kable(head(test_cos[111:113,]), digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[111:113,], col = 6, pch = 16,
     xlim = c(-1,1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[111:113,], labels = rownames(sup$coor[111:113,],),
     col = 6, pos = 1, font = 3, srt=-45) # srt es para rotar el texto
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[111:113,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[111:113,], col = 6, pch = 16)
text(sup$coor[111:113,], labels = rownames(sup$coor[111:113,]),
     col = 6, pos = 1, font = 3, srt=-45)
```

## Motocicleta

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
kable(pes_dist_coor[114:116,], digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
kable(head(test_cos[114:116,]), digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[114:116,], col = 6, pch = 16,
     xlim = c(-1,1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[114:116,], labels = rownames(sup$coor[114:116,],),
     col = 6, pos = 1, font = 3, srt=-45) # srt es para rotar el texto
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[114:116,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[114:116,], col = 6, pch = 16)
text(sup$coor[114:116,], labels = rownames(sup$coor[114:116,]),
     col = 6, pos = 1, font = 3, srt=-45)
```

## Consola de videojuegos

Los pesos, distancias al cuadrado y las nuevas coordenadas son:

```{r}
#| echo: false
kable(pes_dist_coor[117:119,], digits = 3)
```

Los valores test y los cosenos cuadrados son:

```{r}
#| echo: false
kable(head(test_cos[117:119,]), digits = 3)
```

```{r}
#| echo: false
#| eval: false
plot(sup$coor[117:119,], col = 6, pch = 16,
     xlim = c(-1,1), ylim = c(-1,1),
     bty="n", axes = FALSE)
text(sup$coor[117:119,], labels = rownames(sup$coor[117:119,],),
     col = 6, pos = 1, font = 3, srt=-45) # srt es para rotar el texto
curve(sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
curve(-sqrt(1 - x*x), -1, 1, 1e4, add = TRUE, lty = 3)
abline(h=0, col="grey"); abline(v=0, col="grey")
s.arrow(acp$co, add.plot = TRUE, boxes = T,
        xax = 1, yax = 2)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE,
        xax = 1, yax = 2)
```

```{r}
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
     xlim = c(min(sup$coor[117:119,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = T)
s.arrow(GGlob, add.plot = TRUE, boxes = FALSE)
points(sup$coor[117:119,], col = 6, pch = 16)
text(sup$coor[117:119,], labels = rownames(sup$coor[117:119,]),
     col = 6, pos = 1, font = 3, srt=-45)
```
:::

Se vio que las personas que pagan una cantidad considerablemente mayor de dinero tienen mejores puntajes, aunado a que también los individuos de estratos más altos tenían en promedio puntajes más altos que los de estratos más bajos. Por último, se vio que en casi todas las preguntas referentes a poseer o no algun objeto o servicio, los individuos que respondían afirmativamente a estas preguntas tenían en promedio mejores puntajes que los que no poseen estos bienes o a los que se desconocía de si poseen estos bienes, a excepción de la motocicleta, en donde se vio que los individuos que no poseen motocicleta tenían mejores puntajes que los que sí poseen motocicleta. 

Resalta que en general, los individuos con mejores puntajes en promedio tienen características asociadas a un nivel socioeconómico alto, como un estrato alto, un valor de matrícula mayor o tener acceso a algunos bienes y servicios.
