# Análisis bivariado

A continuación se muestra un adelanto de los resultados del análisis bivariado de ciertas variables de la base de datos a trabajar.

```{r}
#| echo: false
#| results: hide
#| message: false
#| warning: false

library(FactoClass)
library(plotly)
library(knitr)
library(readr)
library(dplyr)

# Carga de datos originales
saberpro <- read_delim("DATA_ICFES_SABERPROPROFESIONAL_2022-2.TXT", delim = "¬", escape_double = FALSE, trim_ws = TRUE)
kable(head(saberpro), digits=2) 

# nuestros datos
data <- saberpro[,-c(1,2,5:9,13:15,17:21,23:26,28:34,49:54,56:62,65,67:70,72:75,77:82,84:86,88:90,92:94,96:98,100:102,104:109)]

# genero
sum(is.na(data$ESTU_GENERO)) # hay 5 NA'S
data$ESTU_GENERO <- ifelse(is.na(data$ESTU_GENERO), "Desconocido", data$ESTU_GENERO)
data$ESTU_GENERO <- as.factor(data$ESTU_GENERO)
table(data$ESTU_GENERO)

# edad
# esta la quitamos
library(stringr)
edad <- str_sub(data$ESTU_FECHANACIMIENTO,7,10)
edad<-as.numeric(edad)
edades<-2023-edad

# etnia
sum(is.na(data$ESTU_TIENEETNIA)) # 775 na's
data$ESTU_TIENEETNIA <- ifelse(is.na(data$ESTU_TIENEETNIA), "Desconocido", data$ESTU_TIENEETNIA)
data$ESTU_TIENEETNIA <- as.factor(data$ESTU_TIENEETNIA)
table(data$ESTU_TIENEETNIA)

# depto
data$ESTU_DEPTO_RESIDE<-ifelse(data$ESTU_DEPTO_RESIDE %in% c("BARCELONA","BUENOS AIRES","FRANKFURT","HOUSTON","LIMA","MIAMI","NUEVA YORK","PARIS","QUEBEC","ROMA","SACRAMENTO","SANTIAGO DE CHILE","SAO PAULO","SEUL","TRENTON"),"EXTRANJERO",data$ESTU_DEPTO_RESIDE)
sum(is.na(data$ESTU_DEPTO_RESIDE))
length(unique(data$ESTU_DEPTO_RESIDE)) # hay 35 pq son mas los extranjeros y NAs
data$ESTU_DEPTO_RESIDE <- ifelse(is.na(data$ESTU_DEPTO_RESIDE), "Desconocido", data$ESTU_DEPTO_RESIDE)
data$ESTU_DEPTO_RESIDE <- as.factor(data$ESTU_DEPTO_RESIDE)
data <- data %>%
  mutate(ESTU_DEPTO_RESIDE = case_when(
    ESTU_DEPTO_RESIDE == "BOGOTÁ" ~ ESTU_DEPTO_RESIDE,
    ESTU_DEPTO_RESIDE == "Desconocido" ~ "Desconocido",
    TRUE ~ "OTRO"
  ))
data$ESTU_DEPTO_RESIDE <- as.factor(data$ESTU_DEPTO_RESIDE)
table(data$ESTU_DEPTO_RESIDE)


# estado civil
sum(is.na(data$ESTU_ESTADOCIVIL)) # 580 na's
data$ESTU_ESTADOCIVIL <- ifelse(is.na(data$ESTU_ESTADOCIVIL), "Desconocido", ifelse(data$ESTU_ESTADOCIVIL=="Casado","C",ifelse(data$ESTU_ESTADOCIVIL=="Separado y/o Viudo","SyoV",ifelse(data$ESTU_ESTADOCIVIL=="Soltero","S","UL"))))
data$ESTU_ESTADOCIVIL <- as.factor(data$ESTU_ESTADOCIVIL)
table(data$ESTU_ESTADOCIVIL)

# valor matrícula
## recodificamos para que quede como factor
sum(is.na(data$ESTU_VALORMATRICULAUNIVERSIDAD)) # 2194 na's
data$ESTU_VALORMATRICULAUNIVERSIDAD <- ifelse(is.na(data$ESTU_VALORMATRICULAUNIVERSIDAD), "Desconocido", ifelse(data$ESTU_VALORMATRICULAUNIVERSIDAD=="Menos de 500 mil","m500",ifelse(data$ESTU_VALORMATRICULAUNIVERSIDAD=="Entre 500 mil y menos de 1 millón","e500m1",ifelse(data$ESTU_VALORMATRICULAUNIVERSIDAD=="Entre 1 millón y menos de 2.5 millones","e1m2.5",ifelse(data$ESTU_VALORMATRICULAUNIVERSIDAD=="Entre 2.5 millones y menos de 4 millones","e2.5m4",ifelse(data$ESTU_VALORMATRICULAUNIVERSIDAD=="Entre 4 millones y menos de 5.5 millones","e4m5.5",ifelse(data$ESTU_VALORMATRICULAUNIVERSIDAD=="Entre 5.5 millones y menos de 7 millones","e5.5m7",ifelse(data$ESTU_VALORMATRICULAUNIVERSIDAD=="Más de 7 millones","M7","NP"))))))))
data$ESTU_VALORMATRICULAUNIVERSIDAD <- factor(data$ESTU_VALORMATRICULAUNIVERSIDAD, levels = c("m500","e500m1", "e1m2.5", "e2.5m4","e4m5.5","e5.5m7","M7","NP","Desconocido"))
table(data$ESTU_VALORMATRICULAUNIVERSIDAD)

# capacitacion del examen
sum(is.na(data$ESTU_COMOCAPACITOEXAMENSB11)) # 2069 na's
data$ESTU_COMOCAPACITOEXAMENSB11 <- ifelse(is.na(data$ESTU_COMOCAPACITOEXAMENSB11), "Desconocido", ifelse(data$ESTU_COMOCAPACITOEXAMENSB11=="No realizó ninguna prueba de preparación","Ninguna",ifelse(data$ESTU_COMOCAPACITOEXAMENSB11=="Repasó por cuenta propia","CuentaPropia","Curso")))
data$ESTU_COMOCAPACITOEXAMENSB11 <- as.factor(data$ESTU_COMOCAPACITOEXAMENSB11)
table(data$ESTU_COMOCAPACITOEXAMENSB11)


# semestre que cursa
sum(is.na(data$ESTU_SEMESTRECURSA)) # 2194 na's
data$ESTU_SEMESTRECURSA<-ifelse(data$ESTU_SEMESTRECURSA %in% c("01","02","03","04","05","06"),"06m",ifelse(data$ESTU_SEMESTRECURSA=="12 o más","12M",data$ESTU_SEMESTRECURSA))
data$ESTU_SEMESTRECURSA <- ifelse(is.na(data$ESTU_SEMESTRECURSA), "Desconocido", data$ESTU_SEMESTRECURSA)
data$ESTU_SEMESTRECURSA <- as.factor(data$ESTU_SEMESTRECURSA)
table(data$ESTU_SEMESTRECURSA)

# educacion papa
sum(is.na(data$FAMI_EDUCACIONPADRE)) # 4738 na's
data$FAMI_EDUCACIONPADRE <- ifelse(is.na(data$FAMI_EDUCACIONPADRE), "Desconocido", ifelse(data$FAMI_EDUCACIONPADRE=="Educación profesional completa","EPC",ifelse(data$FAMI_EDUCACIONPADRE=="Educación profesional incompleta","EPI",ifelse(data$FAMI_EDUCACIONPADRE=="No Aplica","NAp",ifelse(data$FAMI_EDUCACIONPADRE=="No sabe","NS",ifelse(data$FAMI_EDUCACIONPADRE=="Postgrado","Post",ifelse(data$FAMI_EDUCACIONPADRE=="Primaria completa","PC",ifelse(data$FAMI_EDUCACIONPADRE=="Primaria incompleta","PI",ifelse(data$FAMI_EDUCACIONPADRE=="Secundaria (Bachillerato) completa","BC",ifelse(data$FAMI_EDUCACIONPADRE=="Secundaria (Bachillerato) incompleta","BI",ifelse(data$FAMI_EDUCACIONPADRE=="Técnica o tecnológica completa","TTC",ifelse(data$FAMI_EDUCACIONPADRE=="Técnica o tecnológica incompleta","TTI",data$FAMI_EDUCACIONPADRE))))))))))))
data$FAMI_EDUCACIONPADRE <- as.factor(data$FAMI_EDUCACIONPADRE)
table(data$FAMI_EDUCACIONPADRE)

# educacion mama
sum(is.na(data$FAMI_EDUCACIONMADRE)) # 4886 na's
data$FAMI_EDUCACIONMADRE <- ifelse(is.na(data$FAMI_EDUCACIONMADRE), "Desconocido", ifelse(data$FAMI_EDUCACIONMADRE=="Educación profesional completa","EPC",ifelse(data$FAMI_EDUCACIONMADRE=="Educación profesional incompleta","EPI",ifelse(data$FAMI_EDUCACIONMADRE=="No Aplica","NAp",ifelse(data$FAMI_EDUCACIONMADRE=="No sabe","NS",ifelse(data$FAMI_EDUCACIONMADRE=="Postgrado","Post",ifelse(data$FAMI_EDUCACIONMADRE=="Primaria completa","PC",ifelse(data$FAMI_EDUCACIONMADRE=="Primaria incompleta","PI",ifelse(data$FAMI_EDUCACIONMADRE=="Secundaria (Bachillerato) completa","BC",ifelse(data$FAMI_EDUCACIONMADRE=="Secundaria (Bachillerato) incompleta","BI",ifelse(data$FAMI_EDUCACIONMADRE=="Técnica o tecnológica completa","TTC",ifelse(data$FAMI_EDUCACIONMADRE=="Técnica o tecnológica incompleta","TTI",data$FAMI_EDUCACIONMADRE))))))))))))
data$FAMI_EDUCACIONMADRE <- as.factor(data$FAMI_EDUCACIONMADRE)
table(data$FAMI_EDUCACIONMADRE)

# ocupacion papa
sum(is.na(data$FAMI_OCUPACIONPADRE)) # 2060 na's
data$FAMI_OCUPACIONPADRE <- ifelse(is.na(data$FAMI_OCUPACIONPADRE), "Desconocido", ifelse(data$FAMI_OCUPACIONPADRE=="Empleado con cargo como director o gerente general","EDGG",ifelse(data$FAMI_OCUPACIONPADRE=="Empleado de nivel auxiliar o administrativo","ENAA",ifelse(data$FAMI_OCUPACIONPADRE=="Empleado de nivel directivo","END",ifelse(data$FAMI_OCUPACIONPADRE=="Empleado de nivel técnico o profesional","ENTP",ifelse(data$FAMI_OCUPACIONPADRE=="Empleado obrero u operario","EOO",ifelse(data$FAMI_OCUPACIONPADRE=="Empresario","Emp",ifelse(data$FAMI_OCUPACIONPADRE=="Hogar","H",ifelse(data$FAMI_OCUPACIONPADRE=="Otra actividad u ocupación","OAO", ifelse(data$FAMI_OCUPACIONPADRE=="Pensionado","Pen",ifelse(data$FAMI_OCUPACIONPADRE=="Pequeño empresario","PE",ifelse(data$FAMI_OCUPACIONPADRE=="Profesional independiente","PI","TCP"))))))))))))
data$FAMI_OCUPACIONPADRE <- as.factor(data$FAMI_OCUPACIONPADRE)
table(data$FAMI_OCUPACIONPADRE)

# ocupacion mama
sum(is.na(data$FAMI_OCUPACIONMADRE)) # 2060 na's
data$FAMI_OCUPACIONMADRE <- ifelse(is.na(data$FAMI_OCUPACIONMADRE), "Desconocido", ifelse(data$FAMI_OCUPACIONMADRE=="Empleado con cargo como director o gerente general","EDGG",ifelse(data$FAMI_OCUPACIONMADRE=="Empleado de nivel auxiliar o administrativo","ENAA",ifelse(data$FAMI_OCUPACIONMADRE=="Empleado de nivel directivo","END",ifelse(data$FAMI_OCUPACIONMADRE=="Empleado de nivel técnico o profesional","ENTP",ifelse(data$FAMI_OCUPACIONMADRE=="Empleado obrero u operario","EOO",ifelse(data$FAMI_OCUPACIONMADRE=="Empresario","Emp",ifelse(data$FAMI_OCUPACIONMADRE=="Hogar","H",ifelse(data$FAMI_OCUPACIONMADRE=="Otra actividad u ocupación","OAO", ifelse(data$FAMI_OCUPACIONMADRE=="Pensionado","Pen",ifelse(data$FAMI_OCUPACIONMADRE=="Pequeño empresario","PE",ifelse(data$FAMI_OCUPACIONMADRE=="Profesional Independiente","PI","TCP"))))))))))))
data$FAMI_OCUPACIONMADRE <- as.factor(data$FAMI_OCUPACIONMADRE)
table(data$FAMI_OCUPACIONMADRE)

# estrato
sum(is.na(data$FAMI_ESTRATOVIVIENDA)) # 5531 na's
data$FAMI_ESTRATOVIVIENDA <- ifelse(is.na(data$FAMI_ESTRATOVIVIENDA), "Desconocido", data$FAMI_ESTRATOVIVIENDA)
data$FAMI_ESTRATOVIVIENDA <- as.factor(data$FAMI_ESTRATOVIVIENDA)
table(data$FAMI_ESTRATOVIVIENDA)


# internet
sum(is.na(data$FAMI_TIENEINTERNET)) # 5697 na's
data$FAMI_TIENEINTERNET <- ifelse(is.na(data$FAMI_TIENEINTERNET), "Desconocido", data$FAMI_TIENEINTERNET)
data$FAMI_TIENEINTERNET <- as.factor(data$FAMI_TIENEINTERNET)
table(data$FAMI_TIENEINTERNET)

# computador
sum(is.na(data$FAMI_TIENECOMPUTADOR)) # 6163 na's
data$FAMI_TIENECOMPUTADOR <- ifelse(is.na(data$FAMI_TIENECOMPUTADOR), "Desconocido", data$FAMI_TIENECOMPUTADOR)
data$FAMI_TIENECOMPUTADOR <- as.factor(data$FAMI_TIENECOMPUTADOR)
table(data$FAMI_TIENECOMPUTADOR)

# lavadora
sum(is.na(data$FAMI_TIENELAVADORA)) # 6354 na's
data$FAMI_TIENELAVADORA <- ifelse(is.na(data$FAMI_TIENELAVADORA), "Desconocido", data$FAMI_TIENELAVADORA)
data$FAMI_TIENELAVADORA <- as.factor(data$FAMI_TIENELAVADORA)
table(data$FAMI_TIENELAVADORA)

# microogas
sum(is.na(data$FAMI_TIENEHORNOMICROOGAS)) # 7019 na's
data$FAMI_TIENEHORNOMICROOGAS <- ifelse(is.na(data$FAMI_TIENEHORNOMICROOGAS), "Desconocido", data$FAMI_TIENEHORNOMICROOGAS)
data$FAMI_TIENEHORNOMICROOGAS <- as.factor(data$FAMI_TIENEHORNOMICROOGAS)
table(data$FAMI_TIENEHORNOMICROOGAS)

# tv
sum(is.na(data$FAMI_TIENESERVICIOTV)) # 5801 na's
data$FAMI_TIENESERVICIOTV <- ifelse(is.na(data$FAMI_TIENESERVICIOTV), "Desconocido", data$FAMI_TIENESERVICIOTV)
data$FAMI_TIENESERVICIOTV <- as.factor(data$FAMI_TIENESERVICIOTV)
table(data$FAMI_TIENESERVICIOTV)

# auto
sum(is.na(data$FAMI_TIENEAUTOMOVIL)) # 7187 na's
data$FAMI_TIENEAUTOMOVIL <- ifelse(is.na(data$FAMI_TIENEAUTOMOVIL), "Desconocido", data$FAMI_TIENEAUTOMOVIL)
data$FAMI_TIENEAUTOMOVIL <- as.factor(data$FAMI_TIENEAUTOMOVIL)
table(data$FAMI_TIENEAUTOMOVIL)

# moto
sum(is.na(data$FAMI_TIENEMOTOCICLETA)) # 7525 na's
data$FAMI_TIENEMOTOCICLETA <- ifelse(is.na(data$FAMI_TIENEMOTOCICLETA), "Desconocido", data$FAMI_TIENEMOTOCICLETA)
data$FAMI_TIENEMOTOCICLETA <- as.factor(data$FAMI_TIENEMOTOCICLETA)
table(data$FAMI_TIENEMOTOCICLETA)

# consola
sum(is.na(data$FAMI_TIENECONSOLAVIDEOJUEGOS)) # 7993 na's
data$FAMI_TIENECONSOLAVIDEOJUEGOS <- ifelse(is.na(data$FAMI_TIENECONSOLAVIDEOJUEGOS), "Desconocido", data$FAMI_TIENECONSOLAVIDEOJUEGOS)
data$FAMI_TIENECONSOLAVIDEOJUEGOS <- as.factor(data$FAMI_TIENECONSOLAVIDEOJUEGOS)
table(data$FAMI_TIENECONSOLAVIDEOJUEGOS)

# horas trabaja
sum(is.na(data$ESTU_HORASSEMANATRABAJA)) # 6867 na's
data$ESTU_HORASSEMANATRABAJA <- ifelse(is.na(data$ESTU_HORASSEMANATRABAJA), "Desconocido", data$ESTU_HORASSEMANATRABAJA)
data$ESTU_HORASSEMANATRABAJA <- factor(data$ESTU_HORASSEMANATRABAJA, levels = c("0", "Menos de 10 horas", "Entre 11 y 20 horas", "Entre 21 y 30 horas", "Más de 30 horas", "Desconocido"))
table(data$ESTU_HORASSEMANATRABAJA)

# grupo de referencia
sum(is.na(data$GRUPOREFERENCIA)) # 0 na's
data$GRUPOREFERENCIA<-ifelse(data$GRUPOREFERENCIA=="ADMINISTRACIÓN Y AFINES","AdmYAfin",ifelse(data$GRUPOREFERENCIA=="ARQUITECTURA Y URBANISMO","ArqYUrb",ifelse(data$GRUPOREFERENCIA=="BELLAS ARTES Y DISEÑO","BelArtYDis",ifelse(data$GRUPOREFERENCIA=="CIENCIAS AGROPECUARIAS","CienAgr",ifelse(data$GRUPOREFERENCIA=="CIENCIAS MILITARES Y NAVALES","CienMilYNav",ifelse(data$GRUPOREFERENCIA=="CIENCIAS NATURALES Y EXACTAS","CienNatYExac",ifelse(data$GRUPOREFERENCIA=="CIENCIAS SOCIALES","CienSoc",ifelse(data$GRUPOREFERENCIA=="COMUNICACIÓN, PERIODISMO Y PUBLICIDAD","ComuPerYPub",ifelse(data$GRUPOREFERENCIA=="CONTADURÍA Y AFINES","ContYAfin",ifelse(data$GRUPOREFERENCIA=="DERECHO","Derecho",ifelse(data$GRUPOREFERENCIA=="ECONOMÍA","Economía",ifelse(data$GRUPOREFERENCIA=="ECONOMÍA, ADMINISTRACIÓN, CONTADURÍA Y AFINES - UNIVERSITARIA","EcAdContYAfinU",ifelse(data$GRUPOREFERENCIA=="EDUCACIÓN","Educación",ifelse(data$GRUPOREFERENCIA=="ENFERMERÍA","Enfermeria",ifelse(data$GRUPOREFERENCIA=="GRUPO REFERENCIA NACIONAL","GrupRefNal", ifelse(data$GRUPOREFERENCIA=="GRUPO REFERENCIA NACIONAL UNIVERSITARIO","GrupRefNalU", ifelse(data$GRUPOREFERENCIA=="HUMANIDADES","Hum", ifelse(data$GRUPOREFERENCIA=="INGENIERÍA","Inge", ifelse(data$GRUPOREFERENCIA=="MEDICINA","Med", ifelse(data$GRUPOREFERENCIA=="PSICOLOGÍA","Psic", ifelse(data$GRUPOREFERENCIA=="RECREACIÓN Y DEPORTES","RecYDep", "salud")))))))))))))))))))))
data$GRUPOREFERENCIA<- as.factor(data$GRUPOREFERENCIA)
table(data$GRUPOREFERENCIA)
str(data$GRUPOREFERENCIA) # 22 niveles

# metodo
sum(is.na(data$ESTU_METODO_PRGM)) # 0 na's
data$ESTU_METODO_PRGM <- ifelse(data$ESTU_METODO_PRGM == "DISTANCIA VITUAL", "distVirtual", ifelse(data$ESTU_METODO_PRGM=="DISTANCIA","distancia","presencial"))
data$ESTU_METODO_PRGM<- as.factor(data$ESTU_METODO_PRGM)
table(data$ESTU_METODO_PRGM)

# caracter academico institucion
sum(is.na(data$INST_CARACTER_ACADEMICO)) # 0 na's
data$INST_CARACTER_ACADEMICO<-ifelse(data$INST_CARACTER_ACADEMICO=="INSTITUCIÓN TECNOLÓGICA","InstTec",ifelse(data$INST_CARACTER_ACADEMICO=="INSTITUCIÓN UNIVERSITARIA","InstUni", ifelse(data$INST_CARACTER_ACADEMICO=="TÉCNICA PROFESIONAL","TecProf", "Universidad")))
data$INST_CARACTER_ACADEMICO<- as.factor(data$INST_CARACTER_ACADEMICO)
table(data$INST_CARACTER_ACADEMICO)

names(data)[29:33]<-c("cuanti","lec","ciu","ing","esc")
```
## Variables cuantitativas

```{r}
#| eval: false
#| echo: false
# mejor no ponerlo pq se ve horrible y no sé si realmente diga mucho
plotpairs(as.matrix(data[,29:34]))
```

```{r}
#| echo: false
# Matriz de correlaciones
kable(cor(data[,29:34]), digits = 2)
```

La correlación lineal entre cada componente y el puntaje global en general es alta. Entre componentes sin embargo no pasa lo mismo, ya que por ejemplo, la correlación entre el componente de escritura y los demás componentes es baja, mientras que la correlación entre componentes como lectura y competencias ciudadanas o razonamiento cuantitativo y lectura es más alta.

## Variables continua y cualitativa

Se comparará el puntaje global respecto a distintas variables de interés a través de boxplots con el fin de observar si hay una diferencia entre las distribuciones de los puntajes en las distintas variables cualitativas de interés. 

### Puntaje global vs cualitativas

::: panel-tabset
### Sexo

```{r}
#| echo: false
sorted_sexo <- with(data, reorder(ESTU_GENERO, PUNT_GLOBAL, median, na.rm = T))
boxplot(data$PUNT_GLOBAL ~ sorted_sexo, las = 1, col = 4, horizontal = T)
```

Las dos cajas son parecidas, lo que puede indicar que el sexo no afecta a los puntajes, sin embargo, en el caso de los que tienen un sexo desconocido, si parece haber una mayor puntuación media y una concentración alrededor de 150 y 200.

### Estado civil

```{r}
#| echo: false
par(bty="n")
sorted_civil <- with(data, reorder(ESTU_ESTADOCIVIL, PUNT_GLOBAL, median, na.rm = T))
boxplot(data$PUNT_GLOBAL ~ sorted_civil, las = 1, col = 4, horizontal = T)
```

En general todas las cajas son muy parecidas y aunque algunas son un poco más delgadas, todas tienen una distribución similar, por lo que el estado civil no parece afectar al puntaje global.

### Horas trabaja

```{r}
#| echo: false
par(bty="n")
sorted_horas <- with(data, reorder(ESTU_HORASSEMANATRABAJA, PUNT_GLOBAL, median, na.rm = T))
boxplot(data$PUNT_GLOBAL ~ sorted_horas, las = 1, col = 4, horizontal = T)
```

Las cajas parecen distribuirse de igual manera, sin enmbargo, los que no trabajan parecen tener puntajes un poco más altos en promedio respecto a las otras categorías, pero visualmente la diferencia no es muy notoria. 

### Capacitación examen

```{r}
#| echo: false
par(bty="n")
sorted_cap <- with(data, reorder(ESTU_COMOCAPACITOEXAMENSB11, PUNT_GLOBAL, median, na.rm = T))
boxplot(data$PUNT_GLOBAL ~ sorted_cap, las = 1, col = 4, horizontal = T)
```

Las diferencias de puntajes entre distintas capacitaciones no es muy apreciable, por lo que parece que el tipo de capacitación no afecta en gran medida al puntaje global, aunque es notorio que en el caso de estudiar por cuenta propia, hay más datos atípicos tanto por encima como por debajo de la mediana de los puntajes.

### Semestre que cursa

```{r}
#| echo: false
par(bty="n")
sorted_semestre <- with(data, reorder(ESTU_SEMESTRECURSA, PUNT_GLOBAL, median, na.rm = T))
boxplot(data$PUNT_GLOBAL ~ sorted_semestre, las = 1, col = 4, horizontal = T)
```

El semestre no parece afectar enormemente a la distribución del puntaje global, sin embargo sí parece haber una tendencia que indica que a mayores semestres, los puntajes tienden a ser un poco mejores, habiendo una diferencia visualmente notable en por ejemplo, los de 6 semestres o menos y los de 12 semestres o más.

### Grupo referencia

```{r}
#| echo: false
par(bty="n",cex.axis=0.5)
sorted_grupo <- with(data, reorder(GRUPOREFERENCIA, PUNT_GLOBAL, median, na.rm = T))
boxplot(data$PUNT_GLOBAL ~ sorted_grupo, las = 1, col = 4, horizontal = T)
```
En el caso del grupo de referencia, si parece haber un cambio al diferenciar entre distintos grupos de referencia, tanto en distribución como en puntajes, pues para grupos de referencia como Grupo referencia nacional o Econ.,admin.,contad. y afines Univer, los bigotes de las cajas son más cortos que otros grupos, y además hay una clara diferencia en algunas cajas pues por ejemplo, la caja del grupo Econ.,admin.,contad. y afines Univer no se solapa con la caja del grupo de Recreación y deportes, indicando que el grupo de referencia parece afectar de manera significativa al puntaje global.

### Modalidad

```{r}
#| echo: false
par(bty="n")
sorted_modalidad <- with(data, reorder(ESTU_METODO_PRGM, PUNT_GLOBAL, median, na.rm = T))
boxplot(data$PUNT_GLOBAL ~ sorted_modalidad, las = 1, col = 4, horizontal = T)
```

La modalidad no parece afectar demasiado al puntaje global ya que las cajas se solapan, sin embargo si se puede apreciar una diferencia entre los puntajes con individuos en modalidad presencial y con individuos en modalidad a distancia, ya que el percentil 75 de ambos grupos es menor que la mediana del grupo de modalidad presencial.

### Carácter académico

```{r}
#| echo: false
par(bty="n")
sorted_car <- with(data, reorder(INST_CARACTER_ACADEMICO, PUNT_GLOBAL, median, na.rm = T))
boxplot(data$PUNT_GLOBAL ~ sorted_car, las = 1, col = 4, horizontal = T)
```
Aunque las cajas se solapan, los puntajes globales de los individuos que están en una universidad son un poco mayores, debido a que la mediana de los estudiantes en universidad es mayor que las de los individuos que asisten a una institución de carácter académico diferente.

### Valor matrícula

```{r}
#| echo: false
par(bty="n")
sorted_valor <- with(data, reorder(ESTU_VALORMATRICULAUNIVERSIDAD, PUNT_GLOBAL, median, na.rm = T))
boxplot(data$PUNT_GLOBAL ~ sorted_valor, las = 1, col = 4, horizontal = T)
```
Los puntajes globales de los estudiantes que pagan más de 7 millones parecen ser en general más altos respecto a los de otros grupos, mientras que los puntajes entre los demás grupos no parecen diferenciarse demasiado. 

### Estrato

```{r}
#| echo: false
par(bty="n")
sorted_estrato <- with(data, reorder(FAMI_ESTRATOVIVIENDA, PUNT_GLOBAL, median, na.rm = T))
boxplot(data$PUNT_GLOBAL ~ sorted_estrato, las = 1, col = 4, horizontal = T)
```
Hay una clara tendencia que indica que a mayor estrato los puntajes globales tienden a aumentar, ya que, dejando de lado a los individuos con estrato desconocido, los estratos están organizados, siendo los mejores puntajes los de mayor estrato.

:::

## Variables cualitativas

Se compararán las distintas variables cualitativas que son de interés para dar respuesta a los objetivos con variables que no necesariamente dan respuesta a los objetivos pero que se cree que pueden tener una relación con las variables cualitativas que si son de interés. En cada variable se comentarán las observaciones que se obtuvieron de la comparación y y al final se hará un resumen de estas comparaciones.

### Sexo

Hay que recordar que sólo hay 5 individuos con el sexo desconocido, por lo que es normal que la distribución de las distintas variables en esta categoría difiera de la marginal.

::: panel-tabset

#### Estado civil

```{r}
#| echo: false
tc <- table(data$ESTU_GENERO, data$ESTU_ESTADOCIVIL)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```

La distribución de los sexos de cada estado civil es muy parecida a la distribución marginal, por lo que no parece haber una diferencia significativa en la distribución de los sexos en los distintos estados civiles.

En el caso de la distribución de los estados civiles de cada sexo también son muy parecidos a la distribución marginal, a excepción del sexo desconocido, en cuyo caso todos los que poseen esta categoría tienen un estado civil desconocido. De ahí, no parece haber diferencia significativa en la distribución de los estados civiles en cada sexo.

#### Educación padre

```{r}
#| echo: false
tc <- table(data$ESTU_GENERO, data$FAMI_EDUCACIONPADRE)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
En el caso de la distribución de los sexos para los distintos niveles educativos de cada padre no parece diferir mucho entre la mayoría de categorías, sin embargo algunas si se alejan un poco de la distribución marginal, pero no son muy notorias estas diferencias y sólo ocurren en 3 niveles de educación.

Los niveles de educación de los padres son muy parecidas entre los distintos sexos respecto a la distribución marginal, excepto cuando el sexo es desconocido, donde sí se diferencia mucho, debido a la poca cantidad de individuos en esta categoría.

#### Educación madre

```{r}
#| echo: false
tc <- table(data$ESTU_GENERO, data$FAMI_EDUCACIONMADRE)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
En el caso de la distribución de los sexos para los distintos niveles educativos de cada madre sí hay una diferencia un poco notable entre la mayoría de categorías respecto a la distribución marginal. Resalta la categoría que tiene un 10% menos en la proporción de mujeres respecto a la proporción de mujeres en la distribución marginal.

De la misma manera que en la variable anterior, los niveles de educación de las madres son muy parecidos entre los distintos sexos respecto a la distribución marginal, excepto cuando el sexo es desconocido, donde sí se diferencia mucho por la cantidad mínima de individuos en esta categoría. Esto se obviará en las siguientes comparaciones.


#### Ocupación padre

```{r}
#| echo: false
tc <- table(data$ESTU_GENERO, data$FAMI_OCUPACIONPADRE)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
La distribución de los sexos diferenciando entre los distintas ocupaciones del padre difieren en general de la distribución marginal pero no de gran manera, aunque si es apreciable.

La distribución de las ocupaciones del padre diferenciando entre sexos son muy parecidas a la de la distribución marginal. No parece haber diferencia entre sexos.

#### Ocupación madre

```{r}
#| echo: false
tc <- table(data$ESTU_GENERO, data$FAMI_OCUPACIONMADRE)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
La distribución de los sexos diferenciando entre los distintas ocupaciones de la madre difieren en general un poco menos de la distribución marginal respecto a la variable anterior, pero tampoco de gran manera. Igualmente sigue siendo apreciable.

La distribución de las ocupaciones de la madre diferenciando entre sexos también son muy parecidas a la de la distribución marginal. No parece haber diferencia entre sexos.

#### Horas trabaja

```{r}
#| echo: false
tc <- table(data$ESTU_GENERO, data$ESTU_HORASSEMANATRABAJA)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
Las distribución de los sexos entre las distintas categorías de esta variable no parecen cambiar mucho de la marginal, aunque si parece haber una diferencia apreciable entre la distribución marginal y el grupo de personas que no trabajan, puesto que hay proporcionalmente más mujeres en este grupo que la proporción de hombres y mujeres en la población.

La distribución de horas que trabajan los individuos diferenciando entre sexos es muy parecida a la distribución marginal. No parece haber diferencia entre sexos.

#### Capacitación examen

```{r}
#| echo: false
tc <- table(data$ESTU_GENERO, data$ESTU_COMOCAPACITOEXAMENSB11)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```

La distribución de sexos respecto a la forma en la que se capacitaron para el examen de los individuos se parece mucho a la distribución marginal, excepto por las personas que se capacitaron a través de un curso, ya que parece haber una cantidad considerable de más mujeres en proporción respecto a la proporción de mujeres en la población.

La distribución de la forma en la que se capacitaron los individuos para el examen diferenciando entre sexos es muy parecida a la distribución marginal. No parece haber diferencia entre sexos.

#### Semestre cursa

```{r}
#| echo: false
tc <- table(data$ESTU_GENERO, data$ESTU_SEMESTRECURSA)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
La distribución de los sexos diferenciando por el semestre que cursa el individuo parece diferenciarse de la marginal en varias categorías, por lo que para los distintos semestres cursados hay en su mayoría una proporción distinta de mujeres y hombres que en la población.

La distribución de los semestres cursados entre los distintos sexos no parece diferenciarse mucho de la distribución marginal, o lo mismo, no parece haber diferencia entre sexos.

#### Grupo referencia

```{r}
#| echo: false
tc <- table(data$ESTU_GENERO, data$GRUPOREFERENCIA)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
La distribución de los sexos diferenciando por el grupo de referencia del individuo se diferencia de gran manera de la distribución marginal en varias categorías, o lo mismo hay una clara diferencia en la distribución de hombres y mujeres en los distintos grupos de referencia, además de respecto a la población.

En este caso la distribución de  los grupos de referencia entre los distintos sexos sí parece diferenciarse de la distribución marginal, no excesivamente pero si se llega a apreciar este cambio entre las distintas categorías.

#### Modalidad

```{r}
#| echo: false
tc <- table(data$ESTU_GENERO, data$ESTU_METODO_PRGM)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
La distribución de los sexos entre modalidades de estudio no se diferencia mucho de la distribución marginal. No hay una diferencia que llame la atención entre las categorías.

La distribución de las modalidades de estudio en cada sexo se parece mucho a la distribución marginal, por lo que no parece haber diferencia entre sexos.

#### Caracter académico

```{r}
#| echo: false
tc <- table(data$ESTU_GENERO, data$INST_CARACTER_ACADEMICO)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
La proporción de hombres que pertenecen a un instituto tecnológico es notoriamente mayor que la proporción de hombres de la población, de ahí, la distribución de hombres y mujeres diferenciando entre el carácter académico de la institución no se diferencia mucho de la distribución de hombres y mujeres en la población.

La distribución del carácter académico de la institución a la que pertenecen los individuos en cada sexo no se diferencia mucho de la marginal, por lo que no parece que haya diferencias notorias entre sexos.

#### Valor matrícula

```{r}
#| echo: false
tc <- table(data$ESTU_GENERO, data$ESTU_VALORMATRICULAUNIVERSIDAD)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```

La distribución de los sexos respecto a el valor que pagan de matrícula es muy parecida a la distribución marginal. No parece haber diferencias de proporción de hombres y mujeres en los distintos valores de la matrícula.

La distribución de valores de matrículas en los sexos es muy parecida a la distribución marginal. No parece haber diferencias entre los sexos.

#### Estrato

```{r}
#| echo: false
tc <- table(data$ESTU_GENERO, data$FAMI_ESTRATOVIVIENDA)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
La distribución de los sexos respecto a los estratos, en general es muy parecida a la distribución marginal. Sin embargo hay diferencias que parecen no ser muy significativas pero que son apreciables.

La distribución de estratos en ambos sexos es muy parecida a la distribución marginal. No parece haber diferencias entre los sexos.

:::

Resumiendo, en la mayoría de las variables no había diferencia en la distribución de hombres y mujeres, aunque si se pudo apreciar una diferencia en varias categorías en las variables Educación madre, Ocupación padre, Ocupación madre, Semestre cursa, grupo referencia, y estrato, por lo que puede que sean variables que dependen de el sexo, y además se pudo apreciar diferencias notables en sólo una categoría en las variables Horas trabaja, Capacitación examen, Modalidad y Carácter académico, donde había más proporción de un sexo que del otro notoriamente respecto a la distribución marginal. En general lo que ocurría es que la proporción de mujeres era mayor a la proporción de mujeres en la población, sin embargo en el caso de la variable Carácter académico, la proporción de hombres que hacen parte de un instituto tecnológico es mayor que la proporción de hombres en la población. 

Además, en el caso del sexo, la distribución de las distintas variables no difería entre hombres y mujeres en casi todas las variables, sin embargo sí hubo diferencias en la distribución de hombres y mujeres en la variable grupo de referencia. Esto puede indicar que la distribución de hombres y mujeres en las distintas carreras es notablemente distinta.

Las observaciones ponen en el foco a las mujeres ya que parecen diferenciarse un poco más de la población.

### Horas trabaja

En el caso de la esta variable, la cantidad de individuos con la categoría desconocido es de 6867, por lo que aunque sigue siendo un porcentaje bajo respecto al del total de la población, es más notorio, lo que hará que esta categoría sea menos problemática y muestre información que valga la pena tomar en cuenta.

::: panel-tabset

#### Estado civil

```{r}
#| echo: false
tc <- table(data$ESTU_HORASSEMANATRABAJA, data$ESTU_ESTADOCIVIL)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
La distribución de horas de trabajo entre los estados civiles difiere de la distribución marginal en varias categorías, mostrando que individuos con los estados civiles Union libre, Casado y Separado y/o viudo trabajan en promedio más horas que individuos con estado civil soltero o personas con estado civil desconocido.

En el caso de la distribución de estados civiles en las distintas categorías de horas de trabajo, en la mayoría de categorías hay una distribución parecida a la distribución marginal, sin embargo en el caso de las personas que no trabajan hay una diferencia notoria, habiendo una cantidad considerablemente mayor de gente soltera respecto a las otras categorías.

Esto parece indicarnos que la gente que trabaja menos horas o directamente no trabaja es principalmente soltera, algo que presuntamente puede ir ligado con la edad.

#### Semestre cursa

```{r}
#| echo: false
tc <- table(data$ESTU_HORASSEMANATRABAJA, data$ESTU_SEMESTRECURSA)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
La distribución de horas de trabajo no resulta muy parecida en todas las categorías del semestre cursado por el individuo, pero tampoco difiere excesivamente, ya que todas las categorías se solapan entre sí. Las diferencias más notorias respecto a la distribución marginal se ven en las personas que cursan los semestres más avanzados y las personas que cursan los semestres menos avanzados, trabajando más horas respecto a la población.

La distribución de semestre cursado respecto a las horas de trabajo del individuo no difiere en general de la distribución marginal, la distribución que más se diferencia de la marginal es la de los individuos que no trabajan.

#### Grupo referencia

```{r}
#| echo: false
tc <- table(data$ESTU_HORASSEMANATRABAJA, data$GRUPOREFERENCIA)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
La distribución de horas de trabajo respecto a el grupo de referencia varia notoriamente, hay grupos de referencia en los que la distribución de horas de trabajo muestra una clara mayoría en pocas o nulas horas de trabajo, mientras que en otros grupos las horas de trabajo son más que en la distribución de la población.

En general la distribución de grupos de referencia respecto a las horas de trabajo es similar a la distribución marginal, sin embargo, los que trabajan más de 30 horas y los que no trabajan tienen una distribución que se diferencia de la marginal.

#### Valor matrícula

```{r}
#| echo: false
tc <- table(data$ESTU_HORASSEMANATRABAJA, data$ESTU_VALORMATRICULAUNIVERSIDAD)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
Hay una clara diferencia entre los que pagan más de 7 millones y la distribución marginal, pues estos trabajan menos horas que los demás grupos, por otra parte, los que pagan entre 1 millón y 2.5 millones parecen trabajan en promedio más horas que los demás grupos y que la población en general.

En cuanto a la distribución de los costos de matrículas y las horas de trabajo, los que más se diferencian de la distribución marginal son los que trabajan menos horas, teniendo costos más elevados de matrícula, y los que trabajan más de 30 horas, teniendo costos mas pequeños de matrícula.

#### Estrato

```{r}
#| echo: false
tc <- table(data$ESTU_HORASSEMANATRABAJA, data$FAMI_ESTRATOVIVIENDA)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
Los estratos 4, 5 y 6 trabajan menos horas en promedio, mientras que los estratos 1, 2, 3 y las personas sin estrato tienen distribución de las horas de trabajo similar a la marginal. Resalta el hecho de que la mayoría de personas con estrato desconocido también tienen un número de horas de trabajo desconocido, y dado que la cantidad de observaciones en esta categoría es de 5531, es algo que resulta importante tomar en cuenta.

De la misma manera, las personas con horas de trabajo desconocidas contienen a la mayor parte de personas con estrato desconocido, diferenciando enormemente la distribución de estratos en esta categoría respecto a la distribución marginal. De ahí, las categorías son similares a la distribución marginal, resaltando que los que trabajan menos horas parecen tener estratos más altos que la población.

#### Educación padre

```{r}
#| echo: false
tc <- table(data$ESTU_HORASSEMANATRABAJA, data$FAMI_EDUCACIONPADRE)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
La distribución de horas de trabajo en las personas cuyo padre tiene posgrado se diferencian notoriamente de la distribución marginal, pues estas personas trabajan menos horas que los demás grupos. Hay otros grupos que también trabajan menos horas, presuntamente el grupo con un padre con educación profesional completa también trabaja menos. Mismo caso que la variable anterior, la mayoría de personas cuyas horas de trabajo son desconocidas se concentran en el nivel de educación superior del padre desconocido.

De la misma manera, la mayoría personas con un padre con educación desconocida se concentran en el grupo de personas con horas de trabajo desconocidas. De ahí, las distribuciones de niveles de educación del padre por horas de trabajo son muy parecidas a la marginal, sin embargo de nuevo las personas que no trabajan tienden a tener una distribución un poco distinta a la marginal, resaltando que en proporción hay notoriamente más padres con posgrados y con educación profesional completa que en la población.

#### Educación madre

```{r}
#| echo: false
tc <- table(data$ESTU_HORASSEMANATRABAJA, data$FAMI_EDUCACIONMADRE)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
Se repiten los mismos patrones que con la educación del padre.

#### Ocupación padre

```{r}
#| echo: false
tc <- table(data$ESTU_HORASSEMANATRABAJA, data$FAMI_OCUPACIONPADRE)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
Las personas con padres con cargos más altos parecen trabajar menos que la población, por ejemplo como es el caso de los individuos con padres empresarios o con padres empleados a nivel técnico o profesional. 

Como en los anteriores casos, resaltan las personas que no trabajan, teniendo una distribución de ocupación del padre que se diferencia notoriamente de la distribución marginal, pues en estos individuos los padrees en general tienen cargos más altos, como empleado con cargo como director o gerente general, empresarios, y empleados de nivel técnico o profesional.

#### Ocupación madre

```{r}
#| echo: false
tc <- table(data$ESTU_HORASSEMANATRABAJA, data$FAMI_OCUPACIONMADRE)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
Como en el caso anterior, las personas con madres con cargos más altos parecen trabajar en promedio menos horas.

Resalta el hecho de que, a diferencia de la variable anterior, muchas de las madres trabajan en el hogar, independientemente de las horas de trabajo del individuo. Además de esto, sigue notandose una diferencia entre las personas que no trabajan y la ocupación de la madre, pues para estos individuos las madres tienen cargos más altos.

:::

Resumiendo, en la mayoría de las variables el grupo que no trabaja y el grupo que trabaja más de 30 horas a la semana parece diferenciarse de la población. Se presenció que en general el grupo que no trabaja y en general las personas que trabajan menos horas se asociaron a un nivel socioeconómico más alto, siendo que los grupos que trabajaban pocas horas parecían tener padres y madres con mejores cargos, con un mayor nivel educativo, una matrícula y un estrato más alto que los demás. 

Además, en la mayoría de casos, la distribución de las variables en el grupo que no trabaja se diferenciaba notoriamente la distribución marginal, teniendo en general mayor concentración de variables asociadas a un nivel socioeconómico más alto.

También resaltó que en algunas variables, los valores desconocidos de las variables se concentraban en las personas con horas de trabajo desconocidas, por lo que parece que en algunas preguntas del cuestionario, las personas que no respondieron en esas preguntas tampoco respondieron en la pregunta referente a las horas de trabajo.

Las categorías que quedan en el foco después de las observaciones son las personas que no trabajan y las personas que trabajan más de 30 horas.

### Estado civil

En esta variable hay 580 personas con estado civil desconocido, por lo que es un porcentaje muy bajo de la población y por tanto puede llevar a resultados que no sean muy confiables, pero se tendrán en cuenta en las observaciones a menos que parezcan llevar a ideas carentes de sentido.

::: panel-tabset

#### Semestre cursa

```{r}
#| echo: false
tc <- table(data$ESTU_ESTADOCIVIL, data$ESTU_SEMESTRECURSA)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
Las personas que cursan semestres más avanzados parecen tener una concentración mayor de gente soltera en proporción que la población. Además, las personas que cursan semestres menos avanzados tienen una proporción mayor de casados, separados y/o viudos y personas en unión libre que el resto de grupos y que la población. Resalta que las personas en semestres desconocidos tienen la mayor cantidad de personas con estado civil desconocido.

En general la distribución del semestre que cursa en los distintos estados civiles no difiere de gran manera respecto a la distribución marginal, sin embargo la distribución del semestre que cursa en personas con estado civil desconocido si se diferencian enormemente de la distribución marginal, siendo notoria una clara mayoría de personas a las que se desconoce el semestre que cursan.

#### Grupo referencia

```{r}
#| echo: false
tc <- table(data$ESTU_ESTADOCIVIL, data$GRUPOREFERENCIA)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
Hay diferencias claras entre la distribución del estado civil entre varios grupos de referencia respecto a la distribución marginal, resaltando un grupo con una proporción notablemente mayor de personas con estado civil desconocido.

En el caso de la distribución de grupos de referencia con respecto al estado civil del individuo, varios grupos se diferencian de la distribución marginal, siendo estos los individuos en Unión libre, Separados y/o viudos y Casados. Los individuos solteros tienen una distribución muy parecida a la distribución marginal, y los individuos con estado civil desconocido también poseen diferencias notorias.

#### Modalidad

```{r}
#| echo: false
tc <- table(data$ESTU_ESTADOCIVIL, data$ESTU_METODO_PRGM)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
Resalta el hecho de que hay más personas casadas y en unión libre estudiando en modalidades a distancia virtual y a distancia, mientras que la distribución de estados civiles en la modalidad presencial se asemeja a la distribución marginal.

La distribución de las distintas modalidades de estudio en las personas solteras y con estado civil desconocido se parecen de manera considerable a la marginal, mientras que las personas separadas y/o viudas, Casadas y en Unión libre tienen una distribución de la modalidad de estudio notoriamente diferente respecto a la marginal, habiendo menos personas que estudian de manera presencial.

#### Carácter académico

```{r}
#| echo: false
tc <- table(data$ESTU_ESTADOCIVIL, data$INST_CARACTER_ACADEMICO)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
La distribución de estados civiles que más se parece a la distribución marginal aparece en las personas que estudian en una universidad, mientras que la distribución de estados civiles de las personas que estudian en una institución de carácter académico diferente no tienen un parecido tan notorio con la distribución marginal. Resalta el grupo de personas que estudian en una institución tecnológica, pues hay más proporción de personas casadas, separadas y/o viudas y personas en unión libre que en la población.

Como en las variables anteriores, la distribución del carácter académico de la institución a la que pertenece el individuo se parece mucho a la distribución marginal en el caso de las personas solteras y con estado civil desconocido, mientras que las personas casadas, en unión libre y separadas y/o viudas se diferencian notoriamente de la distribución marginal, teniendo una proporción considerablemente menor de personas que estudian en una universidad.

#### Estrato

```{r}
#| echo: false
tc <- table(data$ESTU_ESTADOCIVIL, data$FAMI_ESTRATOVIVIENDA)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
Resalta que las personas en los estratos 4, 5 y 6 tienen una distribución de estados civiles distinta a la marginal, habiendo una concentración mayor de solteros y una concentración menor de personas casadas y en unión libre. De ahí las demás categorías presentan una distribución parecida a la distribución marginal. También se observa que las personas sin estrato tienen una proporción mayor de personas en unión libre respecto al resto de grupos y a la distribución marginal.

En general la distribución de los estratos entre los distintos estados civiles es muy parecida a la marginal, los que más se diferencian son las personas en unión libre y casados, teniendo más personas con un menor estrato.

:::

Resumiendo, en la mayoría de variables parece haber una diferencia notoria principalmente entre la distribución del estado civil en las distintas categorías, habiendo siempre una concentración mayor de casados, separados y/o viudos y personas en unión libre en algunas categorías, y en cambio en otras una concentración mucho mayor de personas solteras.

Además, en el caso del estado civil, la distribución de las demás variables para las personas solteras era parecida en su mayoría a la distribución marginal, patrón que curiosamente también apareció en algunas variables, en personas con estado civil desconocido, mientras que la distribución de las variables en las personas casadas, separadas y/o viudas y en unión libre era notoriamente distinta de la distribución marginal.

### Semestre cursa

La cantidad de personas con el semestre que cursa desconocido es de 2194, por lo que es una cantidad que aunque en proporción es pequeña, igual merece ser tomada en cuenta y puede presentar información pertinente.

::: panel-tabset

#### Grupo referencia

```{r}
#| echo: false
tc <- table(data$ESTU_SEMESTRECURSA, data$GRUPOREFERENCIA)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```

La distribución del semestre que cursa cada persona entre los distintos grupos de referencia es muy distinta, en general, a la distribución marginal. 

En el caso de la distribución de los grupos de referencia respecto al semestre que cursa el individuo, hay tres categorías cuya distribución se diferencia mucho de la marginal, siendo las de personas que cursan el semestre 12 o más, personas que cursan el semestre 11 y personas que cursan el semestre 6 o menos. De ahí, igual las categorías en general difieren de la distribución marginal, pero no de manera tan notable como en las tres categorías anteriores.

#### Capacitación examen

```{r}
#| echo: false
tc <- table(data$ESTU_SEMESTRECURSA, data$ESTU_COMOCAPACITOEXAMENSB11)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
Resalta a primera vista que todas las personas cuya capacitación para el examen es desconocida, el semestre que cursan también es desconocido. De ahí, la distribución del semestre que cursa en las distintas formas de capacitarse para el examen es muy parecida a la distribución marginal.

Asimismo, también ocurre que a la mayoría de personas que están en un semestre desconocido, también se desconoce la manera de capacitación para el examen. Las demás categorías parecen tener distribuciones similares a la de la distribución marginal, resaltando las personas que cursan el semestre 12 o más y el semestre 11, siendo las que se diferencian un poco más de la distribución marginal.

#### Modalidad

```{r}
#| echo: false
tc <- table(data$ESTU_SEMESTRECURSA, data$ESTU_METODO_PRGM)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
La distribución del semestre que cursa el individuo en las distintas modalidades de estudio se diferencia de la distribución marginal cuando la modalidad es distancia virtual o distancia, mientras que, como en el caso del estado civil, la distribución de esta variable en la modalidad presencial se asemeja a la distribución marginal.

Resulta curioso que para los semestres más avanzados y para los semestres menos avanzados la distribución de la modalidad de estudio es muy diferente a la distribución marginal, habiendo en proporción más personas en modalidad presencial en semestres avanzados, y habiendo más personas en modalidad a distancia o distancia virtual en semestres menos avanzados.

#### Estrato

```{r}
#| echo: false
tc <- table(data$ESTU_SEMESTRECURSA, data$FAMI_ESTRATOVIVIENDA)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
Para los estratos más altos, la distribución de los semestres que cursa el individuo se diferencia en mayor medida de la distribución marginal respecto a los otros estratos. También resalta que las personas sin estrato también tienen una distribución notablemente distinta de semestre que cursa el individuo a la marginal.

Resalta que las personas en los semestres más avanzados o que el semestre es desconocido, los estratos son más altos, de ahí, las demás categorías presentan una distribución de los estratos muy parecida a la distribución marginal.

#### Valor matrícula

```{r}
#| echo: false
tc <- table(data$ESTU_SEMESTRECURSA, data$ESTU_VALORMATRICULAUNIVERSIDAD)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
Ocurre un caso curioso, en ambos sentidos, todas las personas con valor de la matrícula desconocido están en un semestre desconocido, y todas las personas en un semestre desconocido tienen un valor de la matrícula desconocido, diferenciandose de manera abismal con la distribución marginal en ambos casos.

En general la distribución de el semestre que cursa el individuo en cada valor de la matrícula se parece mucho a la marginal, exceptuando por las personas que pagan más de 7 millones en matrícula, en cuyo caso la distribución del semestre que cursa es muy distinta a la marginal. La distribución de personas que pagan entre 1 y 2.5 millones también parece distinguirse un poco de la marginal, pero sólo porque hay una cantidad considerablemente mayor de personas en el semestre 8 respecto a los demás grupos.

Para los semestres avanzados, la distribución del valor de la matrícula es muy distinta a la distribución marginal, habiendo una proporción muy alta de gente con matrículas de más de 7 millones. De ahí, la distribución del valor de la matrícula diferenciando entre el semestre que cursa el individuo se parece mucho a la distribución marginal.

:::

Resumiendo, las variables parecen tener una distribución de el semestre que cursa distinta a la marginal debido a los individuos que cursaban o bien semestres más avanzados, o bien semestres menos avanzados. 

Cuando se revisó la distribución de las distintas variables diferenciando por el semestre que cursa, se encontró que las distribuciones que más se diferenciaban de la marginal eran las de los individuos que cursaban semestres o bien más avanzados, siendo el semestre 11 o 12 o más, o bien menos avanzados, siendo el semestre 6 o menos.

También resaltó que en algunas variables el desconocer el valor de la variable no representaba una diferencia notoria respecto a la distribución marginal, mientras que en otras, el desconocer la variable parecía estar estrechamente ligado a desconocer el semestre que cursa el individuo.

### Valor matrícula

Para esta variable también hay 2194 personas a las que se desconoce el valor de la matrícula, por lo que es pertinente ver cómo se comporta esta categoría comparandola con otras variables.

::: panel-tabset

#### Estrato

```{r}
#| echo: false
tc <- table(data$ESTU_VALORMATRICULAUNIVERSIDAD, data$FAMI_ESTRATOVIVIENDA)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
Para los distintos estratos la distribución de valores de la matrícula difiere mucho de la marginal, viendose una clara tendencia de que a estratos más altos, valores en la matrícula mayores, y a estratos más bajos, menores valores en la matrícula.

En el caso de los distintos valores de la matrícula, hay una mayor proporción de personas con estrato alto en valores mayores de la matrícula, mientras que para valores menores de la matrícula hay una menor o nula presencia de personas con estrato alto.

#### Grupo referencia

```{r}
#| echo: false
tc <- table(data$ESTU_VALORMATRICULAUNIVERSIDAD, data$GRUPOREFERENCIA)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
La distribución de valores de matrículas entre los distintos grupos, aunque para algunos grupos se parece a la marginal, para otros difiere enormemente.

Por otra parte, la distribución de los distintos grupos de referencia difiere de la distribución marginal principalmente para costos más elevados de la matrícula, con una proporción grande de individuos que pertenecen al grupo de referencia enfermería.

#### Modalidad

```{r}
#| echo: false
tc <- table(data$ESTU_VALORMATRICULAUNIVERSIDAD, data$ESTU_METODO_PRGM)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
Mientras la distribución de valores de matricula es muy parecida entre la modalidad presencial y la distribución marginal, las modalidades distancia virtual y distancia tienen una distribución mucho más distinta a la marginal, siendo notoria la nula presencia de valores altos en la matrícula para modalidades de estudio a distancia o distancia virtual.

Se notan diferencias grandes entre las distribución de las distintas modalidades de estudio y el valor de la matrícula, puesto que para valores altos de la matrícula la modalidad es presencial en su mayoría o totalidad mientras que para valoresde la matrícula entre 1 y 2.5 millones hay una proporción mucho mayor de estudiantes en modalidad a distancia o distancia virtual respecto a la distribución marginal.

#### Carácter académico

```{r}
#| echo: false
tc <- table(data$ESTU_VALORMATRICULAUNIVERSIDAD, data$INST_CARACTER_ACADEMICO)
tabtc <- cbind(tc, totF = rowSums(tc))
tabtc <- rbind(tabtc, totC=colSums(tabtc))

# Gráficos de los perfiles fila y perfiles columna
par(mfrow=c(2,1), mai=c(0.4,1,0.3,0.1))
plotct(t(tc), "row", col=2:5)
plotct(tc, "row", col=2:10)
```
La distribución de los valores de matrícula para individuos que estudian en una universidad se parece un poco a la distribución marginal, mientras que para las instituciones de un carácter académico distinto, la distribución de valores de matrícula difiere en gran medida de la marginal, habiendo una proporción mayor de matrículas menos costosas respecto a la distribución marginal.

La distribución del carácter académico de la institución del individuo difiere mucho entre distintos valores de matrículas, habiendo una mayor proporción de individuos que estudian en una universidad en valores más altos de la matrícula respecto a  la distribución marginal, y habiendo una mayor proporción de individuos que estudian en instituciones universitarias, técnicas profesionales o instituciones tecnológicas en valores medios de la matrícula. Para los valores más bajos de la matrícula se vuelve a presentar una mayor concentración de estudiantes que hacen parte de una universidad.

:::

Resumiendo la información presentada anteriormente, el valor de la matrícula parece estar estrechamente ligado con variables como el estrato, la modalidad de estudio o el carácter académico de la institución, puesto que las matrículas más caras se encuentran en instituciones con modalidad presencial y universidades, mientras que las matrículas con valores un poco menores se encuentra en instituciones con modalidad a distancia o distancia virtual y siendo instituciones universitarias, tecnológicas o técnicas profesionales.


